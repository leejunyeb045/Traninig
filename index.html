<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">í† ì •ë¹„ê²° & ì‚¬ì£¼íŒ”ì - í•œêµ­ ì „í†µ ìš´ì„¸ ë¶„ì„</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <!-- html2canvas for screenshot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Noto Serif KR', serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #f5f0e8;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-card {
            background: rgba(22, 33, 62, 0.8);
            border: 1px solid rgba(212, 165, 116, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .bg-card-hover {
            transition: all 0.3s ease;
        }

        .bg-card-hover:hover {
            border-color: rgba(212, 165, 116, 0.6);
            box-shadow: 0 12px 48px rgba(212, 165, 116, 0.2);
            transform: translateY(-2px);
        }

        .text-gold {
            color: #d4a574;
        }

        .text-cream {
            color: #f5f0e8;
        }

        .border-gold {
            border-color: rgba(212, 165, 116, 0.5);
        }

        .gradient-text {
            background: linear-gradient(135deg, #d4a574, #c9a96e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .pillar-box {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            border: 2px solid rgba(212, 165, 116, 0.6);
            font-family: 'Noto Serif KR', serif;
            font-size: 28px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .pillar-box:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.3);
        }

        .pillar-box {
            position: relative;
            cursor: pointer;
        }

        .pillar-tooltip {
            display: none;
            position: absolute;
            bottom: calc(100% + 12px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(26, 26, 46, 0.97);
            border: 1px solid rgba(212, 165, 116, 0.7);
            border-radius: 10px;
            padding: 14px 18px;
            min-width: 220px;
            z-index: 200;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            pointer-events: none;
        }

        .pillar-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: rgba(212, 165, 116, 0.7);
        }

        .pillar-box:hover .pillar-tooltip {
            display: block;
        }

        .tooltip-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 3px 0;
            font-size: 13px;
        }

        .tooltip-label {
            color: #a0a0a0;
        }

        .tooltip-value {
            color: #f5f0e8;
            font-weight: 600;
        }

        .tooltip-title {
            color: #d4a574;
            font-weight: bold;
            font-size: 15px;
            margin-bottom: 8px;
            text-align: center;
            border-bottom: 1px solid rgba(212, 165, 116, 0.3);
            padding-bottom: 6px;
        }

        .wood { background: linear-gradient(135deg, rgba(76, 175, 80, 0.3), rgba(139, 195, 74, 0.3)); }
        .fire { background: linear-gradient(135deg, rgba(244, 67, 54, 0.3), rgba(255, 112, 67, 0.3)); }
        .earth { background: linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 167, 38, 0.3)); }
        .metal { background: linear-gradient(135deg, rgba(189, 189, 189, 0.3), rgba(158, 158, 158, 0.3)); }
        .water { background: linear-gradient(135deg, rgba(33, 150, 243, 0.3), rgba(0, 188, 212, 0.3)); }

        .section {
            scroll-margin-top: 100px;
            opacity: 0;
            animation: fadeInUp 0.8s ease forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            visibility: visible;
            transition: all 0.5s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(212, 165, 116, 0.3);
            border-top: 4px solid #d4a574;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .pattern {
            background-image:
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 10px,
                    rgba(212, 165, 116, 0.05) 10px,
                    rgba(212, 165, 116, 0.05) 20px
                );
        }

        .tab-button {
            position: relative;
            cursor: pointer;
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: #a0a0a0;
            font-size: 15px;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .tab-button.active {
            color: #d4a574;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d4a574, transparent);
        }

        .input-field {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 165, 116, 0.3);
            color: #f5f0e8;
            padding: 12px 16px;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .input-field:focus {
            outline: none;
            border-color: #d4a574;
            box-shadow: 0 0 16px rgba(212, 165, 116, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .btn-primary {
            background: linear-gradient(135deg, #d4a574, #c9a96e);
            color: #1a1a2e;
            padding: 12px 32px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: #d4a574;
            padding: 10px 20px;
            border: 1px solid #d4a574;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .btn-secondary:hover {
            background: rgba(212, 165, 116, 0.1);
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#d4a574 0deg, #d4a574 var(--score-deg), rgba(212, 165, 116, 0.2) var(--score-deg), rgba(212, 165, 116, 0.2) 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            font-family: 'Noto Serif KR', serif;
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.2);
        }

        .hexagram {
            display: flex;
            flex-direction: column;
            gap: 2px;
            font-size: 24px;
            font-family: monospace;
            justify-content: center;
            align-items: center;
        }

        .hexagram-line {
            height: 6px;
            display: flex;
            gap: 4px;
        }

        .hexagram-line.solid {
            color: #d4a574;
        }

        .hexagram-line.broken {
            color: #d4a574;
        }

        header {
            animation: slideInLeft 0.8s ease;
        }

        .header-decoration {
            font-size: 24px;
            opacity: 0.6;
            margin: 0 12px;
        }

        .fortune-verse {
            padding: 16px;
            background: rgba(139, 0, 0, 0.1);
            border-left: 3px solid #d4a574;
            border-radius: 4px;
            margin: 8px 0;
        }

        .fortune-verse-chinese {
            font-family: 'Noto Serif KR', serif;
            font-size: 18px;
            color: #d4a574;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .fortune-verse-meaning {
            font-size: 14px;
            color: #d0d0d0;
            line-height: 1.6;
        }

        .month-fortune {
            padding: 12px;
            background: rgba(212, 165, 116, 0.05);
            border: 1px solid rgba(212, 165, 116, 0.2);
            border-radius: 6px;
            margin: 8px 0;
        }

        .month-number {
            color: #d4a574;
            font-weight: bold;
            margin-right: 8px;
        }

        .month-fortune-text {
            color: #d0d0d0;
            font-size: 13px;
        }

        .element-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 4px;
        }

        .element-wood {
            background: rgba(76, 175, 80, 0.3);
            color: #81c784;
        }

        .element-fire {
            background: rgba(244, 67, 54, 0.3);
            color: #ef5350;
        }

        .element-earth {
            background: rgba(255, 193, 7, 0.3);
            color: #ffb74d;
        }

        .element-metal {
            background: rgba(189, 189, 189, 0.3);
            color: #bdbdbd;
        }

        .element-water {
            background: rgba(33, 150, 243, 0.3);
            color: #64b5f6;
        }

        .nav-button {
            position: fixed;
            right: 24px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #d4a574, #c9a96e);
            color: #1a1a2e;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 100;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.3);
        }

        .nav-button:hover {
            transform: scale(1.1);
        }

        .nav-button.scroll-top {
            bottom: 100px;
        }

        .nav-button.print {
            bottom: 30px;
        }

        /* ê¸°ë‘¥ ìˆ˜ì • ëª¨ë‹¬ */
        .pillar-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .pillar-modal.active {
            display: flex;
        }

        .pillar-modal-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 2px solid rgba(212, 165, 116, 0.6);
            border-radius: 16px;
            padding: 28px;
            max-width: 560px;
            width: 92%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 16px 64px rgba(0, 0, 0, 0.5);
        }

        .pillar-modal-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(212, 165, 116, 0.2);
        }

        .pillar-modal-tab {
            padding: 10px 24px;
            border: none;
            background: transparent;
            color: #a0a0a0;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .pillar-modal-tab.active {
            color: #d4a574;
        }

        .pillar-modal-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: #d4a574;
        }

        .pillar-selector-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .pillar-selector-grid.zhi-grid {
            grid-template-columns: repeat(4, 1fr);
        }

        .pillar-selector-item {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid rgba(212, 165, 116, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Serif KR', serif;
            padding: 10px 6px;
        }

        .pillar-selector-item:hover {
            border-color: rgba(212, 165, 116, 0.7);
            transform: scale(1.05);
            box-shadow: 0 4px 16px rgba(212, 165, 116, 0.2);
        }

        .pillar-selector-item.selected {
            border-color: #d4a574;
            background: rgba(212, 165, 116, 0.15);
            box-shadow: 0 0 12px rgba(212, 165, 116, 0.3);
        }

        .pillar-selector-char {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 2px;
        }

        .pillar-selector-info {
            font-size: 11px;
            color: #a0a0a0;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .pillar-edit-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(212, 165, 116, 0.25);
            border: 1px solid rgba(212, 165, 116, 0.5);
            border-radius: 4px;
            padding: 2px 7px;
            font-size: 10px;
            color: #d4a574;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .pillar-edit-btn:hover {
            background: rgba(212, 165, 116, 0.4);
        }

        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }

            header .max-w-7xl {
                padding: 12px 16px !important;
            }

            header h1 {
                font-size: 1.5rem !important;
            }

            header .header-decoration {
                font-size: 16px;
            }

            main {
                padding: 16px 10px !important;
            }

            .section {
                padding: 20px 14px !important;
                margin-bottom: 20px !important;
            }

            h2 {
                font-size: 1.3rem !important;
                margin-bottom: 16px !important;
            }

            h3 {
                font-size: 1rem !important;
            }

            .pillar-box {
                font-size: 18px;
            }

            .grid-4,
            [style*="grid-template-columns: repeat(4, 1fr)"] {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 6px !important;
            }

            .pillar-edit-btn {
                font-size: 8px !important;
                padding: 1px 5px !important;
            }

            .pillar-tooltip {
                min-width: 160px !important;
                padding: 10px !important;
                font-size: 11px !important;
            }

            .grid.grid-cols-1.md\\:grid-cols-2,
            .grid.grid-cols-1.lg\\:grid-cols-2 {
                grid-template-columns: 1fr !important;
            }

            .grid.grid-cols-1.md\\:grid-cols-3,
            .grid.grid-cols-1.lg\\:grid-cols-3 {
                grid-template-columns: 1fr !important;
            }

            .score-circle {
                width: 100px !important;
                height: 100px !important;
                font-size: 28px !important;
            }

            .pillar-modal-content {
                padding: 20px !important;
                width: 95% !important;
            }

            .pillar-selector-grid {
                grid-template-columns: repeat(5, 1fr) !important;
                gap: 6px !important;
            }

            .pillar-selector-grid.zhi-grid {
                grid-template-columns: repeat(4, 1fr) !important;
            }

            .pillar-selector-char {
                font-size: 17px !important;
            }

            .pillar-selector-info {
                font-size: 9px !important;
            }

            .nav-button {
                width: 42px !important;
                height: 42px !important;
                right: 12px !important;
                font-size: 16px !important;
            }

            .nav-button.scroll-top {
                bottom: 70px !important;
            }

            .nav-button.print {
                bottom: 16px !important;
            }

            .flex-wrap.gap-4 {
                flex-direction: column !important;
                gap: 8px !important;
            }

            .flex-wrap.gap-4 button {
                width: 100% !important;
            }

            table {
                font-size: 12px !important;
            }

            table th, table td {
                padding: 8px 10px !important;
            }

            .birth-dropdown-row {
                flex-direction: row !important;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.2rem !important;
            }

            .pillar-box {
                font-size: 15px !important;
            }

            .section {
                padding: 16px 10px !important;
            }

            .birth-dropdown-row select {
                font-size: 13px !important;
                padding: 8px 6px !important;
            }
        }

        /* ë“œë¡­ë‹¤ìš´ ìƒë…„ì›”ì¼ ìŠ¤íƒ€ì¼ */
        .birth-dropdown-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .birth-dropdown-row select {
            flex: 1;
            padding: 10px 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 165, 116, 0.3);
            color: #f5f0e8;
            font-size: 14px;
            font-family: 'Noto Sans KR', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23d4a574' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            padding-right: 26px;
        }

        .birth-dropdown-row select:focus {
            outline: none;
            border-color: #d4a574;
            box-shadow: 0 0 16px rgba(212, 165, 116, 0.2);
            background-color: rgba(255, 255, 255, 0.08);
        }

        .birth-dropdown-row select option {
            background: #1a1a2e;
            color: #f5f0e8;
        }

        /* ì–¸ì–´ ì „í™˜ ë²„íŠ¼ */
        .lang-toggle-btn {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1000;
            background: linear-gradient(135deg, #d4a574, #c9a96e);
            color: #1a1a2e;
            border: none;
            border-radius: 24px;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.4);
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .lang-toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(212, 165, 116, 0.5);
        }

        @media (max-width: 768px) {
            .lang-toggle-btn {
                top: auto;
                bottom: 130px;
                right: 12px;
                padding: 6px 12px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body class="pattern">
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="spinner"></div>
        <p class="mt-6 text-gold text-xl" style="font-family: 'Noto Serif KR', serif;" data-i18n="loading">í† ì •ë¹„ê²°ì„ ê³„ì‚° ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <!-- ê¸°ë‘¥ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="pillar-modal" id="pillarEditModal">
        <div class="pillar-modal-content">
            <div class="flex justify-between items-center mb-5">
                <h3 class="text-xl font-bold text-gold" id="pillarModalTitle" style="font-family: 'Noto Serif KR', serif;">ê¸°ë‘¥ ìˆ˜ì •</h3>
                <button onclick="closePillarEditModal()" style="font-size:24px; background:none; border:none; color:#d4a574; cursor:pointer;">&times;</button>
            </div>

            <div class="pillar-modal-tabs">
                <button class="pillar-modal-tab active" id="ganTab" onclick="switchPillarTab('gan')">ì²œê°„ (å¤©å¹²)</button>
                <button class="pillar-modal-tab" id="zhiTab" onclick="switchPillarTab('zhi')">ì§€ì§€ (åœ°æ”¯)</button>
            </div>

            <div id="ganSelectorPanel">
                <p class="text-xs text-gray-400 mb-3">ì²œê°„ì„ ì„ íƒí•˜ì„¸ìš”</p>
                <div class="pillar-selector-grid" id="ganSelectorGrid"></div>
            </div>

            <div id="zhiSelectorPanel" style="display:none;">
                <p class="text-xs text-gray-400 mb-3">ì§€ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                <div class="pillar-selector-grid zhi-grid" id="zhiSelectorGrid"></div>
            </div>

            <div class="flex gap-3 mt-6">
                <button onclick="applyPillarEdit()" class="btn-primary flex-1 py-3">ì ìš©</button>
                <button onclick="closePillarEditModal()" class="btn-secondary flex-1 py-3">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- ì–¸ì–´ ì „í™˜ ë²„íŠ¼ -->
    <button class="lang-toggle-btn" id="langToggleBtn" onclick="toggleLanguage()">
        ğŸŒ <span id="langToggleLabel">ENG</span>
    </button>

    <!-- Header -->
    <header class="sticky top-0 z-50 bg-card border-b border-gold">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex items-center justify-center gap-3 mb-4">
                <span class="header-decoration">âœ¦</span>
                <h1 class="text-4xl font-bold gradient-text" data-i18n="headerTitle">í† ì •ë¹„ê²° & ì‚¬ì£¼íŒ”ì</h1>
                <span class="header-decoration">âœ¦</span>
            </div>
            <p class="text-center text-gray-400 text-sm" data-i18n="headerSubtitle">í•œêµ­ ì „í†µ ìš´ì„¸ ë¶„ì„ - 2024 ê°œì„ íŒ</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-12">
        <!-- Input Section -->
        <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.1s">
            <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;" data-i18n="inputTitle">ì •ë³´ ì…ë ¥</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Left Column -->
                <div>
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gold mb-2" data-i18n="labelName">ì´ë¦„</label>
                        <input type="text" id="nameInput" class="w-full input-field" data-i18n-placeholder="placeholderName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gold mb-2" data-i18n="labelBirth">ìƒë…„ì›”ì¼ (ì–‘ë ¥)</label>
                        <div class="birth-dropdown-row">
                            <select id="birthYearSelect"></select>
                            <select id="birthMonthSelect"></select>
                            <select id="birthDaySelect"></select>
                        </div>
                        <!-- ê¸°ì¡´ ë¡œì§ í˜¸í™˜ìš© hidden input -->
                        <input type="hidden" id="birthDateInput">
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gold mb-2" data-i18n="labelBirthTime">íƒœì–´ë‚œ ì‹œê°„</label>
                        <select id="birthTimeInput" class="w-full input-field">
                            <option value="" data-i18n="optUnknown">ëª¨ë¦„</option>
                            <option value="0">ìì‹œ (23:30~01:29)</option>
                            <option value="1">ì¶•ì‹œ (01:30~03:29)</option>
                            <option value="2">ì¸ì‹œ (03:30~05:29)</option>
                            <option value="3">ë¬˜ì‹œ (05:30~07:29)</option>
                            <option value="4">ì§„ì‹œ (07:30~09:29)</option>
                            <option value="5">ì‚¬ì‹œ (09:30~11:29)</option>
                            <option value="6">ì˜¤ì‹œ (11:30~13:29)</option>
                            <option value="7">ë¯¸ì‹œ (13:30~15:29)</option>
                            <option value="8">ì‹ ì‹œ (15:30~17:29)</option>
                            <option value="9">ìœ ì‹œ (17:30~19:29)</option>
                            <option value="10">ìˆ ì‹œ (19:30~21:29)</option>
                            <option value="11">í•´ì‹œ (21:30~23:29)</option>
                        </select>
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gold mb-2" data-i18n="labelGender">ì„±ë³„</label>
                        <div class="flex gap-4">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="gender" value="male" class="w-4 h-4" checked>
                                <span class="text-cream" data-i18n="genderMale">ë‚¨ì„±</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="gender" value="female" class="w-4 h-4">
                                <span class="text-cream" data-i18n="genderFemale">ì—¬ì„±</span>
                            </label>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gold mb-2" data-i18n="labelYear">ë¶„ì„ ê¸°ì¤€ ë…„ë„</label>
                        <select id="yearInput" class="w-full input-field">
                        </select>
                    </div>

                    <button class="btn-primary w-full text-lg py-3 font-bold" id="analyzeBtn" data-i18n="analyzeBtn">
                        ìš´ì„¸ ë¶„ì„í•˜ê¸°
                    </button>
                </div>
            </div>
        </section>

        <!-- Results Container (hidden by default) -->
        <div id="resultsContainer" class="hidden">
            <!-- Sajupalzja Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.2s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;" data-i18n="secSaju">
                    âŠ• ì‚¬ì£¼íŒ”ì ë¶„ì„
                </h2>

                <div class="bg-black bg-opacity-30 rounded-lg p-8 mb-8">
                    <p class="text-gold text-center text-sm mb-4 font-semibold" data-i18n="sixtyGapja">ì²œì§€ì¸ ìœ¡ì‹­ê°‘ì</p>
                    <div class="grid grid-4 gap-4" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="pillar-box wood" id="yearPillar" title="ë…„ì£¼">
                            <div class="text-xs text-gray-300 mb-1">ë…„ì£¼</div>
                            <div>--</div>
                        </div>
                        <div class="pillar-box fire" id="monthPillar" title="ì›”ì£¼">
                            <div class="text-xs text-gray-300 mb-1">ì›”ì£¼</div>
                            <div>--</div>
                        </div>
                        <div class="pillar-box earth" id="dayPillar" title="ì¼ì£¼">
                            <div class="text-xs text-gray-300 mb-1">ì¼ì£¼</div>
                            <div>--</div>
                        </div>
                        <div class="pillar-box metal" id="timePillar" title="ì‹œì£¼">
                            <div class="text-xs text-gray-300 mb-1">ì‹œì£¼</div>
                            <div>--</div>
                        </div>
                    </div>
                    <p class="text-center text-xs text-gray-400 mt-6">
                        <span id="pilliarDescription" data-i18n="pillarDesc">ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ ìƒì„¸ ì •ë³´ í™•ì¸ | ìˆ˜ì • ë²„íŠ¼ìœ¼ë¡œ ê¸°ë‘¥ ë³€ê²½ ê°€ëŠ¥</span>
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-gold font-bold mb-4" data-i18n="tenGan">ì‹­ê°„(åå¹²)</h3>
                        <div class="bg-black bg-opacity-20 rounded p-4 mb-3">
                            <div class="text-xs text-gray-400 mb-2" data-i18n="tenGanDesc">ì‹­ê°„ - í•˜ëŠ˜ì˜ ê¸°ìš´ì„ ë‚˜íƒ€ë‚´ëŠ” 10ê°€ì§€ ê¸€ì</div>
                            <div id="tenGanInfo" class="flex flex-wrap gap-1"></div>
                        </div>
                        <h3 class="text-gold font-bold mb-4 mt-4" data-i18n="twelveZhi">ì‹­ì´ì§€(åäºŒæ”¯)</h3>
                        <div class="bg-black bg-opacity-20 rounded p-4">
                            <div class="text-xs text-gray-400 mb-2" data-i18n="twelveZhiDesc">ì‹­ì´ì§€ - ë•…ì˜ ê¸°ìš´ì„ ë‚˜íƒ€ë‚´ëŠ” 12ê°€ì§€ ê¸€ì (12ë )</div>
                            <div id="twelveZhiInfo" class="flex flex-wrap gap-1"></div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-gold font-bold mb-4" data-i18n="sajuElements">ì‚¬ì£¼ ìš”ì†Œ</h3>
                        <div class="space-y-3">
                            <div class="bg-black bg-opacity-20 rounded p-4">
                                <div class="text-xs text-gray-400 mb-2" data-i18n="dayMasterLabel">ì¼ê°„ (ì¼ì£¼ì˜ ì²œê°„) - ë‚˜ ìì‹ ì„ ë‚˜íƒ€ë‚´ëŠ” í•µì‹¬ ìš”ì†Œ</div>
                                <div id="dayMasterInfo" class="text-lg font-bold text-cream">
                                    ç”² ê°‘ëª©(æœ¨)
                                </div>
                                <div id="dayMasterDesc" class="text-xs text-gray-400 mt-1"></div>
                            </div>
                            <div class="bg-black bg-opacity-20 rounded p-4">
                                <div class="text-xs text-gray-400 mb-2" data-i18n="ageLabel">ë‚˜ì´</div>
                                <div id="koreanAgeInfo" class="text-lg font-bold text-cream">
                                    25ì„¸
                                </div>
                                <div id="koreanAgeDetail" class="text-xs text-gray-400 mt-1"></div>
                            </div>
                            <div class="bg-black bg-opacity-20 rounded p-4">
                                <div class="text-xs text-gray-400 mb-2" data-i18n="zodiacLabel">ë  (ìƒë…„ ì§€ì§€)</div>
                                <div id="zodiacInfo" class="text-lg font-bold text-cream">
                                    -
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ì˜¤í–‰ ë¶„ì„ Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.3s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secOhaeng">âŠ• ì˜¤í–‰(äº”è¡Œ) ë¶„ì„</span>
                </h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <div class="bg-black bg-opacity-20 rounded-lg p-8 flex justify-center">
                            <canvas id="elementChart" width="300" height="300"></canvas>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-gold font-bold mb-4" data-i18n="ohaengStatus">ì˜¤í–‰ë³„ í˜„í™©</h3>
                        <div class="space-y-3">
                            <div class="bg-wood rounded p-4 border border-green-500 border-opacity-30">
                                <div class="flex justify-between items-center">
                                    <span class="element-badge element-wood">ëª©(æœ¨) Wood</span>
                                    <span class="text-gold font-bold" id="elementWood">0ê°œ</span>
                                </div>
                            </div>
                            <div class="bg-fire rounded p-4 border border-red-500 border-opacity-30">
                                <div class="flex justify-between items-center">
                                    <span class="element-badge element-fire">í™”(ç«) Fire</span>
                                    <span class="text-gold font-bold" id="elementFire">0ê°œ</span>
                                </div>
                            </div>
                            <div class="bg-earth rounded p-4 border border-yellow-500 border-opacity-30">
                                <div class="flex justify-between items-center">
                                    <span class="element-badge element-earth">í† (åœŸ) Earth</span>
                                    <span class="text-gold font-bold" id="elementEarth">0ê°œ</span>
                                </div>
                            </div>
                            <div class="bg-metal rounded p-4 border border-gray-500 border-opacity-30">
                                <div class="flex justify-between items-center">
                                    <span class="element-badge element-metal">ê¸ˆ(é‡‘) Metal</span>
                                    <span class="text-gold font-bold" id="elementMetal">0ê°œ</span>
                                </div>
                            </div>
                            <div class="bg-water rounded p-4 border border-blue-500 border-opacity-30">
                                <div class="flex justify-between items-center">
                                    <span class="element-badge element-water">ìˆ˜(æ°´) Water</span>
                                    <span class="text-gold font-bold" id="elementWater">0ê°œ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì˜¤í–‰ ì„±í–¥ ê°€ì´ë“œ -->
                <div class="mt-10">
                    <h3 class="text-gold font-bold mb-4 text-lg flex items-center gap-2">
                        <span data-i18n="ohaengGuide">ğŸ“Œ ì˜¤í–‰ ì„±í–¥ ê°€ì´ë“œ</span>
                    </h3>
                    <div class="overflow-x-auto">
                        <table style="width:100%; border-collapse:separate; border-spacing:0; border-radius:10px; overflow:hidden; font-size:14px;">
                            <thead>
                                <tr style="background:rgba(212, 165, 116, 0.15);">
                                    <th style="padding:12px 16px; text-align:left; color:#d4a574; font-weight:700; border-bottom:2px solid rgba(212,165,116,0.3); width:15%;" data-i18n="thElement">ì˜¤í–‰</th>
                                    <th style="padding:12px 16px; text-align:left; color:#d4a574; font-weight:700; border-bottom:2px solid rgba(212,165,116,0.3); width:42%;" data-i18n="thStrong">ê¸°ìš´ì´ ê°•í•  ë•Œ</th>
                                    <th style="padding:12px 16px; text-align:left; color:#d4a574; font-weight:700; border-bottom:2px solid rgba(212,165,116,0.3); width:43%;" data-i18n="thWeak">ê¸°ìš´ì´ ì•½í•  ë•Œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:rgba(76, 175, 80, 0.08); border-bottom:1px solid rgba(255,255,255,0.05);">
                                    <td style="padding:11px 16px; color:#81c784; font-weight:700;" data-i18n="elWood">ëª©</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elWoodStrong">ì ê·¹ì , ì¶”ì§„ë ¥, ê³ ì§‘, ë¶„ë…¸ ì¡°ì ˆ ì–´ë ¤ì›€</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elWoodWeak">ìš°ìœ ë¶€ë‹¨, ì˜ì§€ ë°•ì•½, ì‹œì‘ì€ ìˆìœ¼ë‚˜ ëì´ íë¦¼</td>
                                </tr>
                                <tr style="background:rgba(244, 67, 54, 0.08); border-bottom:1px solid rgba(255,255,255,0.05);">
                                    <td style="padding:11px 16px; color:#ef5350; font-weight:700;" data-i18n="elFire">í™”</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elFireStrong">ì—´ì •ì , í™”ë ¤í•¨, ì„±ê²©ì´ ê¸‰í•¨, ê°ì • ê¸°ë³µ</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elFireWeak">ì†Œê·¹ì , ëƒ‰ì†Œì , í‘œí˜„ë ¥ ë¶€ì¡±, í™œë ¥ ì €í•˜</td>
                                </tr>
                                <tr style="background:rgba(255, 193, 7, 0.08); border-bottom:1px solid rgba(255,255,255,0.05);">
                                    <td style="padding:11px 16px; color:#ffb74d; font-weight:700;" data-i18n="elEarth">í† </td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elEarthStrong">í¬ìš©ë ¥, ì‹ ìš©, ìœµí†µì„± ë¶€ì¡±, ê³ ì§€ì‹í•¨</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elEarthWeak">ë¶ˆì•ˆì •, ëˆê¸° ë¶€ì¡±, ì£¼ê´€ì´ í”ë“¤ë¦¼</td>
                                </tr>
                                <tr style="background:rgba(189, 189, 189, 0.08); border-bottom:1px solid rgba(255,255,255,0.05);">
                                    <td style="padding:11px 16px; color:#bdbdbd; font-weight:700;" data-i18n="elMetal">ê¸ˆ</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elMetalStrong">ê²°ë‹¨ë ¥, ì˜ë¦¬, ëƒ‰í˜¹í•¨, ë¹„íŒì , ê°•ë°•</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elMetalWeak">ë§ºê³  ëŠìŒ ë¶ˆë¶„ëª…, ìš°ìœ ë¶€ë‹¨, ê²°ì‹¤ì´ ì ìŒ</td>
                                </tr>
                                <tr style="background:rgba(33, 150, 243, 0.08);">
                                    <td style="padding:11px 16px; color:#64b5f6; font-weight:700;" data-i18n="elWater">ìˆ˜</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elWaterStrong">ì§€í˜œ, ìœ ì—°í•¨, ìƒê°ì´ ë§ì•„ í–‰ë™ì´ ëŠ¦ìŒ</td>
                                    <td style="padding:11px 16px; color:#e0e0e0;" data-i18n="elWaterWeak">ìœµí†µì„± ë¶€ì¡±, ê²ì´ ë§ìŒ, ì ì‘ë ¥ ë¶€ì¡±</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ë§ì¶¤ í–‰ë™ ì§€ì¹¨ -->
                <div class="mt-10" id="elementAdviceSection">
                    <h3 class="text-gold font-bold mb-4 text-lg flex items-center gap-2">
                        <span data-i18n="customAdvice">ğŸ’¡ ë‹¹ì‹ ì„ ìœ„í•œ ë§ì¶¤ í–‰ë™ ì§€ì¹¨</span>
                    </h3>
                    <div id="elementAdviceCards" class="space-y-4">
                        <p class="text-gray-500 text-sm" data-i18n="advicePlaceholder">ë¶„ì„ í›„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>

            </section>

            <!-- ì„±ê²© ë¶„ì„ Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.4s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secPersonality">âŠ• ì„±ê²© ë¶„ì„</span>
                </h2>

                <div class="bg-black bg-opacity-20 rounded-lg p-8">
                    <h3 class="text-gold font-bold text-xl mb-4" id="personalityTitle">
                        ç”²æœ¨ äºº (Wood Master)
                    </h3>
                    <p class="text-cream leading-relaxed text-base" id="personalityDescription">
                        ë‹¹ì‹ ì˜ ì¼ê°„ì€ ç”²æœ¨(ê°‘ëª©)ì…ë‹ˆë‹¤.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                        <div class="bg-black bg-opacity-30 rounded p-4">
                            <div class="text-xs text-gray-400 mb-2" data-i18n="labelStrength">ê°•ì </div>
                            <p class="text-cream text-sm" id="strengths">ê°•í•œ ì˜ì§€ì™€ ì¶”ì§„ë ¥</p>
                        </div>
                        <div class="bg-black bg-opacity-30 rounded p-4">
                            <div class="text-xs text-gray-400 mb-2" data-i18n="labelWeakness">ì•½ì </div>
                            <p class="text-cream text-sm" id="weaknesses">ê°€ëŠ¥ì„± ìˆëŠ” ì„±ê¸‰í•¨</p>
                        </div>
                        <div class="bg-black bg-opacity-30 rounded p-4">
                            <div class="text-xs text-gray-400 mb-2" data-i18n="labelAptitude">ì ì„±</div>
                            <p class="text-cream text-sm" id="aptitude">ë¦¬ë”ì‹­, ì‚¬ì—…, ì˜ˆìˆ </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- í‰ìƒ ëŒ€ìš´ íë¦„ Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.45s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secDaewun">âŠ• í‰ìƒ ëŒ€ìš´(å¤§é‹) íë¦„</span>
                </h2>
                <p class="text-gray-400 text-sm mb-6" data-i18n="daewunDesc">10ë…„ ë‹¨ìœ„ì˜ í° ìš´ì„¸ íë¦„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ê° ëŒ€ìš´ì€ ì‚¶ì˜ ì£¼ìš” í…Œë§ˆì™€ ì—ë„ˆì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
                <div class="bg-black bg-opacity-20 rounded-lg p-6 mb-6">
                    <canvas id="decadeFlowChart" style="height: 300px;"></canvas>
                </div>
                <div id="decadeFlowDetails" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                </div>
            </section>

            <!-- í† ì •ë¹„ê²° Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.5s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secTojeong">âŠ• í† ì •ë¹„ê²° ìš´ì„¸</span>
                </h2>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                    <div class="flex flex-col items-center justify-center">
                        <h3 class="text-gold font-bold mb-4" data-i18n="upperGua">ìƒê´˜</h3>
                        <div class="hexagram" id="upperHexagram">
                            <div class="hexagram-line solid">â”â”</div>
                            <div class="hexagram-line solid">â”â”</div>
                            <div class="hexagram-line broken">â” â”</div>
                        </div>
                    </div>

                    <div class="flex flex-col items-center justify-center">
                        <h3 class="text-gold font-bold mb-4" data-i18n="middleGua">ì¤‘ê´˜</h3>
                        <div class="hexagram" id="middleHexagram">
                            <div class="hexagram-line solid">â”â”</div>
                            <div class="hexagram-line broken">â” â”</div>
                            <div class="hexagram-line broken">â” â”</div>
                        </div>
                    </div>

                    <div class="flex flex-col items-center justify-center">
                        <h3 class="text-gold font-bold mb-4" data-i18n="lowerGua">í•˜ê´˜</h3>
                        <div class="hexagram" id="lowerHexagram">
                            <div class="hexagram-line broken">â” â”</div>
                            <div class="hexagram-line broken">â” â”</div>
                            <div class="hexagram-line broken">â” â”</div>
                        </div>
                    </div>
                </div>

                <div class="bg-black bg-opacity-30 rounded-lg p-8 mb-8">
                    <h3 class="text-gold font-bold mb-4" data-i18n="yearlyFortune">ì—° ìš´ì„¸</h3>
                    <div class="fortune-verse">
                        <div class="fortune-verse-chinese">æ™‚ä¾†é‹è½‰</div>
                        <div class="fortune-verse-meaning" id="yearFortune">
                            ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ìš´ì´ ì¢‹ì•„ì§„ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-gold font-bold mb-4" data-i18n="monthlyFortune">ì›”ë³„ ìš´ì„¸</h3>
                    <div id="monthlyFortunes" class="space-y-2">
                    </div>
                </div>
            </section>

            <!-- ë¶„ì•¼ë³„ ìš´ì„¸ Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.6s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secCategory">âŠ• ë¶„ì•¼ë³„ ìš´ì„¸</span>
                </h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-black bg-opacity-20 rounded-lg p-8 flex justify-center">
                        <canvas id="fortuneChart" width="300" height="300"></canvas>
                    </div>

                    <div class="space-y-4">
                        <div class="bg-black bg-opacity-30 rounded p-4 border-l-3 border-yellow-600">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gold font-bold" data-i18n="catWealth">ì¬ë¬¼ìš´</span>
                                <span class="text-yellow-400" id="wealthScore">75ì </span>
                            </div>
                            <p class="text-sm text-cream" id="wealthText">ì˜¬í•´ëŠ” ì¬ë¬¼ì´ ë“¤ì–´ì˜¬ ì¢‹ì€ ê¸°ìš´ì´ ë³´ì…ë‹ˆë‹¤.</p>
                        </div>

                        <div class="bg-black bg-opacity-30 rounded p-4 border-l-3 border-red-600">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gold font-bold" data-i18n="catLove">ì—°ì• ìš´</span>
                                <span class="text-red-400" id="loveScore">68ì </span>
                            </div>
                            <p class="text-sm text-cream" id="loveText">ì¢‹ì€ ë§Œë‚¨ê³¼ ì¸ì—°ì˜ ê¸°íšŒê°€ ê¸°ëŒ€ë©ë‹ˆë‹¤.</p>
                        </div>

                        <div class="bg-black bg-opacity-30 rounded p-4 border-l-3 border-green-600">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gold font-bold" data-i18n="catHealth">ê±´ê°•ìš´</span>
                                <span class="text-green-400" id="healthScore">82ì </span>
                            </div>
                            <p class="text-sm text-cream" id="healthText">ì „ë°˜ì ìœ¼ë¡œ ê±´ê°•í•œ í•´ê°€ ë  ê²ƒì…ë‹ˆë‹¤.</p>
                        </div>

                        <div class="bg-black bg-opacity-30 rounded p-4 border-l-3 border-blue-600">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gold font-bold" data-i18n="catCareer">ì§ì—…ìš´</span>
                                <span class="text-blue-400" id="careerScore">79ì </span>
                            </div>
                            <p class="text-sm text-cream" id="careerText">ì—…ë¬´ ëŠ¥ë ¥ì´ ì¸ì •ë°›ì„ ì‹œê°„ì…ë‹ˆë‹¤.</p>
                        </div>

                        <div class="bg-black bg-opacity-30 rounded p-4 border-l-3 border-purple-600">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gold font-bold" data-i18n="catStudy">í•™ì—…ìš´</span>
                                <span class="text-purple-400" id="studyScore">71ì </span>
                            </div>
                            <p class="text-sm text-cream" id="studyText">ì§‘ì¤‘ë ¥ì´ ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ì¢…í•© ì´í‰ Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.7s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secOverall">âŠ• ì¢…í•© ì´í‰</span>
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="flex flex-col items-center justify-center">
                        <h3 class="text-gold font-bold mb-6" id="overallYearLabel" style="font-size:14px; line-height:1.5; word-break:keep-all;">ì „ë°˜ ìš´ì„¸</h3>
                        <div class="score-circle" id="overallScore" style="--score-deg: 270deg">
                            <span>75</span>
                        </div>
                    </div>

                    <div class="col-span-1 md:col-span-2 bg-black bg-opacity-20 rounded-lg p-8">
                        <h3 class="text-gold font-bold mb-4" data-i18n="overallTitle">ì¢…í•© ë¶„ì„</h3>
                        <p class="text-cream leading-relaxed mb-4" id="overallAnalysis">
                            ì˜¬í•´ëŠ” ë‹¹ì‹ ì—ê²Œ ìƒˆë¡œìš´ ê¸°íšŒì™€ ë³€í™”ì˜ í•´ê°€ ë  ê²ƒì…ë‹ˆë‹¤.
                        </p>
                        <p class="text-cream leading-relaxed mb-4" id="overallAdvice">
                            íŠ¹íˆ ìƒë°˜ê¸°ì—ëŠ” ì¬ë¬¼ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤.
                        </p>
                        <p class="text-cream leading-relaxed" id="overallWarning">
                            ì‹ ì¤‘í•¨ê³¼ ê³„íšì„±ìœ¼ë¡œ ë”ìš± í° ì„±ê³µì„ ì´ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </section>

            <!-- Export Section -->
            <section class="section bg-card rounded-lg p-8 mb-12" style="animation-delay: 0.8s">
                <h2 class="text-3xl font-bold gradient-text mb-8" style="font-family: 'Noto Serif KR', serif;">
                    <span data-i18n="secExport">âŠ• ê³µìœ  & ë‚´ë³´ë‚´ê¸°</span>
                </h2>

                <div class="flex flex-wrap gap-4">
                    <button class="btn-secondary" id="copyBtn" data-i18n="btnCopy">
                        ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬
                    </button>
                    <button class="btn-secondary" id="printBtn" data-i18n="btnPrint">
                        ğŸ–¨ï¸ ì¸ì‡„
                    </button>
                    <button class="btn-secondary" id="screenshotBtn" data-i18n="btnScreenshot">
                        ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Navigation Buttons -->
    <button class="nav-button scroll-top hidden" id="scrollTopBtn" title="ìœ„ë¡œ ì´ë™">â–²</button>
    <button class="nav-button print hidden" id="printFloatingBtn" title="ì¸ì‡„">ğŸ–¨ï¸</button>

    <script>
        // ============================================================
        // I18N (ë‹¤êµ­ì–´) SYSTEM
        // ============================================================
        let currentLang = 'ko';

        const I18N = {
            ko: {
                // í˜ì´ì§€ ì œëª©
                pageTitle: 'í† ì •ë¹„ê²° & ì‚¬ì£¼íŒ”ì - í•œêµ­ ì „í†µ ìš´ì„¸ ë¶„ì„',
                headerTitle: 'í† ì •ë¹„ê²° & ì‚¬ì£¼íŒ”ì',
                headerSubtitle: 'í•œêµ­ ì „í†µ ìš´ì„¸ ë¶„ì„ - 2024 ê°œì„ íŒ',
                loading: 'í† ì •ë¹„ê²°ì„ ê³„ì‚° ì¤‘ì…ë‹ˆë‹¤...',
                // ì…ë ¥ í¼
                inputTitle: 'ì •ë³´ ì…ë ¥',
                labelName: 'ì´ë¦„',
                placeholderName: 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”',
                labelBirth: 'ìƒë…„ì›”ì¼ (ì–‘ë ¥)',
                labelBirthTime: 'íƒœì–´ë‚œ ì‹œê°„',
                optUnknown: 'ëª¨ë¦„',
                labelGender: 'ì„±ë³„',
                genderMale: 'ë‚¨ì„±',
                genderFemale: 'ì—¬ì„±',
                labelYear: 'ë¶„ì„ ê¸°ì¤€ ë…„ë„',
                analyzeBtn: 'ìš´ì„¸ ë¶„ì„í•˜ê¸°',
                // ë“œë¡­ë‹¤ìš´
                optYear: 'ì—°ë„', optMonth: 'ì›”', optDay: 'ì¼',
                yearUnit: 'ë…„', monthUnit: 'ì›”', dayUnit: 'ì¼',
                // ì‹œê°„ ì˜µì…˜
                timeOptions: [
                    'ëª¨ë¦„',
                    'ìì‹œ (23:30~01:29)', 'ì¶•ì‹œ (01:30~03:29)', 'ì¸ì‹œ (03:30~05:29)',
                    'ë¬˜ì‹œ (05:30~07:29)', 'ì§„ì‹œ (07:30~09:29)', 'ì‚¬ì‹œ (09:30~11:29)',
                    'ì˜¤ì‹œ (11:30~13:29)', 'ë¯¸ì‹œ (13:30~15:29)', 'ì‹ ì‹œ (15:30~17:29)',
                    'ìœ ì‹œ (17:30~19:29)', 'ìˆ ì‹œ (19:30~21:29)', 'í•´ì‹œ (21:30~23:29)'
                ],
                // ì‚¬ì£¼íŒ”ì ê²°ê³¼
                secSaju: 'âŠ• ì‚¬ì£¼íŒ”ì ë¶„ì„',
                sixtyGapja: 'ì²œì§€ì¸ ìœ¡ì‹­ê°‘ì',
                pillarDesc: 'ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ ìƒì„¸ ì •ë³´ í™•ì¸ | ìˆ˜ì • ë²„íŠ¼ìœ¼ë¡œ ê¸°ë‘¥ ë³€ê²½ ê°€ëŠ¥',
                pillarYear: 'ë…„ì£¼', pillarMonth: 'ì›”ì£¼', pillarDay: 'ì¼ì£¼', pillarTime: 'ì‹œì£¼',
                tenGan: 'ì‹­ê°„(åå¹²)',
                tenGanDesc: 'ì‹­ê°„ - í•˜ëŠ˜ì˜ ê¸°ìš´ì„ ë‚˜íƒ€ë‚´ëŠ” 10ê°€ì§€ ê¸€ì',
                twelveZhi: 'ì‹­ì´ì§€(åäºŒæ”¯)',
                twelveZhiDesc: 'ì‹­ì´ì§€ - ë•…ì˜ ê¸°ìš´ì„ ë‚˜íƒ€ë‚´ëŠ” 12ê°€ì§€ ê¸€ì (12ë )',
                sajuElements: 'ì‚¬ì£¼ ìš”ì†Œ',
                dayMasterLabel: 'ì¼ê°„ (ì¼ì£¼ì˜ ì²œê°„) - ë‚˜ ìì‹ ì„ ë‚˜íƒ€ë‚´ëŠ” í•µì‹¬ ìš”ì†Œ',
                ageLabel: 'ë‚˜ì´',
                zodiacLabel: 'ë  (ìƒë…„ ì§€ì§€)',
                // ì˜¤í–‰
                secOhaeng: 'âŠ• ì˜¤í–‰(äº”è¡Œ) ë¶„ì„',
                ohaengStatus: 'ì˜¤í–‰ë³„ í˜„í™©',
                ohaengGuide: 'ğŸ“Œ ì˜¤í–‰ ì„±í–¥ ê°€ì´ë“œ',
                thElement: 'ì˜¤í–‰', thStrong: 'ê¸°ìš´ì´ ê°•í•  ë•Œ', thWeak: 'ê¸°ìš´ì´ ì•½í•  ë•Œ',
                elWood: 'ëª©', elFire: 'í™”', elEarth: 'í† ', elMetal: 'ê¸ˆ', elWater: 'ìˆ˜',
                elWoodStrong: 'ì ê·¹ì , ì¶”ì§„ë ¥, ê³ ì§‘, ë¶„ë…¸ ì¡°ì ˆ ì–´ë ¤ì›€',
                elWoodWeak: 'ìš°ìœ ë¶€ë‹¨, ì˜ì§€ ë°•ì•½, ì‹œì‘ì€ ìˆìœ¼ë‚˜ ëì´ íë¦¼',
                elFireStrong: 'ì—´ì •ì , í™”ë ¤í•¨, ì„±ê²©ì´ ê¸‰í•¨, ê°ì • ê¸°ë³µ',
                elFireWeak: 'ì†Œê·¹ì , ëƒ‰ì†Œì , í‘œí˜„ë ¥ ë¶€ì¡±, í™œë ¥ ì €í•˜',
                elEarthStrong: 'í¬ìš©ë ¥, ì‹ ìš©, ìœµí†µì„± ë¶€ì¡±, ê³ ì§€ì‹í•¨',
                elEarthWeak: 'ë¶ˆì•ˆì •, ëˆê¸° ë¶€ì¡±, ì£¼ê´€ì´ í”ë“¤ë¦¼',
                elMetalStrong: 'ê²°ë‹¨ë ¥, ì˜ë¦¬, ëƒ‰í˜¹í•¨, ë¹„íŒì , ê°•ë°•',
                elMetalWeak: 'ë§ºê³  ëŠìŒ ë¶ˆë¶„ëª…, ìš°ìœ ë¶€ë‹¨, ê²°ì‹¤ì´ ì ìŒ',
                elWaterStrong: 'ì§€í˜œ, ìœ ì—°í•¨, ìƒê°ì´ ë§ì•„ í–‰ë™ì´ ëŠ¦ìŒ',
                elWaterWeak: 'ìœµí†µì„± ë¶€ì¡±, ê²ì´ ë§ìŒ, ì ì‘ë ¥ ë¶€ì¡±',
                customAdvice: 'ğŸ’¡ ë‹¹ì‹ ì„ ìœ„í•œ ë§ì¶¤ í–‰ë™ ì§€ì¹¨',
                advicePlaceholder: 'ë¶„ì„ í›„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.',
                unitCount: 'ê°œ',
                // ì„±ê²©
                secPersonality: 'âŠ• ì„±ê²© ë¶„ì„',
                labelStrength: 'ê°•ì ', labelWeakness: 'ì•½ì ', labelAptitude: 'ì ì„±',
                // ëŒ€ìš´
                secDaewun: 'âŠ• í‰ìƒ ëŒ€ìš´(å¤§é‹) íë¦„',
                daewunDesc: '10ë…„ ë‹¨ìœ„ì˜ í° ìš´ì„¸ íë¦„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ê° ëŒ€ìš´ì€ ì‚¶ì˜ ì£¼ìš” í…Œë§ˆì™€ ì—ë„ˆì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.',
                daewunLabel: 'ëŒ€ìš´',
                scoreDescBest: 'ìµœìƒì˜ ìš´ê¸°', scoreDescGood: 'ìƒìŠ¹í•˜ëŠ” ìš´',
                scoreDescNormal: 'í‰ë²”í•œ ìš´', scoreDescCaution: 'ì£¼ì˜ê°€ í•„ìš”í•œ ì‹œê¸°',
                fortuneFlow: 'ìš´ì„¸ íë¦„',
                // í† ì •ë¹„ê²°
                secTojeong: 'âŠ• í† ì •ë¹„ê²° ìš´ì„¸',
                upperGua: 'ìƒê´˜', middleGua: 'ì¤‘ê´˜', lowerGua: 'í•˜ê´˜',
                yearlyFortune: 'ì—° ìš´ì„¸', monthlyFortune: 'ì›”ë³„ ìš´ì„¸',
                // ë¶„ì•¼ë³„
                secCategory: 'âŠ• ë¶„ì•¼ë³„ ìš´ì„¸',
                catWealth: 'ì¬ë¬¼ìš´', catLove: 'ì—°ì• ìš´', catHealth: 'ê±´ê°•ìš´',
                catCareer: 'ì§ì—…ìš´', catStudy: 'í•™ì—…ìš´',
                fortuneScore: 'ìš´ì„¸ ì ìˆ˜',
                pointUnit: 'ì ',
                // ì¢…í•©
                secOverall: 'âŠ• ì¢…í•© ì´í‰',
                overallTitle: 'ì¢…í•© ë¶„ì„',
                yearFortuneLabel: 'ì „ë°˜ ìš´ì„¸',
                // ê³µìœ 
                secExport: 'âŠ• ê³µìœ  & ë‚´ë³´ë‚´ê¸°',
                btnCopy: 'ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬', btnPrint: 'ğŸ–¨ï¸ ì¸ì‡„', btnScreenshot: 'ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥',
                // ëª¨ë‹¬
                modalEdit: 'ìˆ˜ì •', modalApply: 'ì ìš©', modalCancel: 'ì·¨ì†Œ',
                ganTabLabel: 'ì²œê°„ (å¤©å¹²)', zhiTabLabel: 'ì§€ì§€ (åœ°æ”¯)',
                ganSelectMsg: 'ì²œê°„ì„ ì„ íƒí•˜ì„¸ìš”', zhiSelectMsg: 'ì§€ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”',
                // í† ìŠ¤íŠ¸
                toastCopyOk: 'ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!',
                toastCopyFail: 'ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
                toastImgGen: 'ì´ë¯¸ì§€ë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...',
                toastImgOk: 'ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!',
                toastImgFail: 'ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸ì‡„ ê¸°ëŠ¥ì„ ì´ìš©í•´ì£¼ì„¸ìš”.',
                toastNoResult: 'ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.',
                toastEdited: 'ì‚¬ì£¼ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!',
                alertInput: 'ìƒë…„ì›”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                // ì„±ê²© ë™ì  í…ìŠ¤íŠ¸
                personalityDesc: {
                    0: { name: 'ç”²æœ¨(ê°‘ëª©)', desc: 'í° ë‚˜ë¬´ë¥¼ ì˜ë¯¸í•˜ëŠ” ì–‘ëª©ìœ¼ë¡œ, ë‹¹ì‹ ì€ íƒì›”í•œ ì§€ë„ë ¥ê³¼ ê°•í•œ ì¶”ì§„ë ¥ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.', str: 'ê°•í•œ ì˜ì§€ë ¥, ë›°ì–´ë‚œ ì§€ë„ë ¥, ë¹ ë¥¸ íŒë‹¨ë ¥', wk: 'ì„±ê¸‰í•¨, ìœµí†µì„± ë¶€ì¡±', apt: 'ë¦¬ë”ì‹­, ì‚¬ì—…, ì˜ˆìˆ ' },
                    1: { name: 'ä¹™æœ¨(ì„ëª©)', desc: 'ì‘ì€ í’€ì´ë‚˜ ë©êµ´ì„ ì˜ë¯¸í•˜ëŠ” ìŒëª©ìœ¼ë¡œ, ìœ ì—°í•˜ê³  ì˜¨í™”í•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ìœ ì—°ì„±, ê°ìˆ˜ì„±, ë”°ëœ»í•¨', wk: 'ìš°ìœ ë¶€ë‹¨í•¨, ê³¼ë¯¼í•¨', apt: 'ì˜ˆìˆ , ìƒë‹´, êµìœ¡' },
                    2: { name: 'ä¸™ç«(ë³‘í™”)', desc: 'íƒ€ì˜¤ë¥´ëŠ” í° ë¶ˆì„ ì˜ë¯¸í•˜ëŠ” ì–‘í™”ë¡œ, ì—´ì •ì ì´ê³  í™œë°œí•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ì—´ì •, ë°ìŒ, í–‰ë™ë ¥', wk: 'ì„±ê¸‰í•¨, í”¼ìƒì„±', apt: 'ì˜ì—…, ì—”í„°í…Œì¸ë¨¼íŠ¸' },
                    3: { name: 'ä¸ç«(ì •í™”)', desc: 'ì´›ë¶ˆì´ë‚˜ ì‘ì€ ë¶ˆì„ ì˜ë¯¸í•˜ëŠ” ìŒí™”ë¡œ, ì˜¨í™”í•˜ê³  ëª…ì§€í•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ê¹Šì€ ì‚¬ê³ , ë”°ëœ»í•¨, ì§€í˜œ', wk: 'ì†Œê·¹ì„±, ì˜ì¡´ì„±', apt: 'í•™ë¬¸, ë¬¸í™”, ìƒë‹´' },
                    4: { name: 'æˆŠåœŸ(ë¬´í† )', desc: 'ë†’ì€ ì‚°ì„ ì˜ë¯¸í•˜ëŠ” ì–‘í† ë¡œ, ì•ˆì •ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ì‹ ë¢°ì„±, ì•ˆì •ì„±, ì±…ì„ê°', wk: 'ê²½ì§ë¨, ìœ ì—°ì„± ë¶€ì¡±', apt: 'ë¶€ë™ì‚°, ê¸ˆìœµ, ê´€ë¦¬' },
                    5: { name: 'å·±åœŸ(ê¸°í† )', desc: 'ë‚®ì€ ë“¤íŒì„ ì˜ë¯¸í•˜ëŠ” ìŒí† ë¡œ, ë¶€ë“œëŸ½ê³  í¬ìš©ë ¥ì´ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤.', str: 'í¬ìš©ë ¥, ì¹œì ˆí•¨, ì„¸ì‹¬í•¨', wk: 'ìš°ìœ ë¶€ë‹¨í•¨, ê²°ë‹¨ë ¥ ë¶€ì¡±', apt: 'HR, ë³µì§€, êµìœ¡' },
                    6: { name: 'åºšé‡‘(ê²½ê¸ˆ)', desc: 'ê´‘ë¬¼ì´ë‚˜ í° ì¹¼ì„ ì˜ë¯¸í•˜ëŠ” ì–‘ê¸ˆìœ¼ë¡œ, ì§ì„ ì ì´ê³  ì •ì§í•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ì •ì§í•¨, ê°•ì¸í•¨, ê²°ë‹¨ë ¥', wk: 'ì™„ê³ í•¨, ëƒ‰ì •í•¨', apt: 'êµ°ì¸, ê²½ì°°, ê¸°ìˆ ì' },
                    7: { name: 'è¾›é‡‘(ì‹ ê¸ˆ)', desc: 'ë³´ì„ì´ë‚˜ ì‘ì€ ì¹¼ì„ ì˜ë¯¸í•˜ëŠ” ìŒê¸ˆìœ¼ë¡œ, ì •êµí•˜ê³  ì„¬ì„¸í•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ì„¬ì„¸í•¨, ì˜ˆë¦¬í•¨, íŒë‹¨ë ¥', wk: 'ì‹ ê²½ê³¼ë¯¼, ê³ ì§‘', apt: 'ì˜ë£Œ, ë¯¸ìš©, ê³¼í•™' },
                    8: { name: 'å£¬æ°´(ì„ìˆ˜)', desc: 'í° ê°•ì´ë‚˜ ë°”ë‹¤ë¥¼ ì˜ë¯¸í•˜ëŠ” ì–‘ìˆ˜ë¡œ, í¬ìš©ë ¥ì´ í¬ê³  ììœ ë¡œìš´ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'í¬ìš©ë ¥, ìœ ì—°ì„±, ì§€í˜œ', wk: 'ìš°ìœ ë¶€ë‹¨í•¨, ì¼ê´€ì„± ë¶€ì¡±', apt: 'ì—¬í–‰, ë¬´ì—­, ìœ í†µ' },
                    9: { name: 'ç™¸æ°´(ê³„ìˆ˜)', desc: 'ì´ìŠ¬ì´ë‚˜ ë¹—ì„ ì˜ë¯¸í•˜ëŠ” ìŒìˆ˜ë¡œ, ë¶€ë“œëŸ½ê³  ì˜ˆë¯¼í•œ ì„±ê²©ì…ë‹ˆë‹¤.', str: 'ê°ì„±, ì„¬ì„¸í•¨, ê³µê°ë ¥', wk: 'ì†Œì‹¬í•¨, ì˜ì¡´ì„±', apt: 'ë¬¸í•™, ì˜ˆìˆ , ì‹¬ë¦¬í•™' }
                },
                // ìš´ì„¸ í…ìŠ¤íŠ¸
                fortuneTexts: {
                    wealth: ['ì¬ë¬¼ìš´ì´ ì•½í•©ë‹ˆë‹¤.','ì–´ëŠ ì •ë„ ì¬ë¬¼ì´ ë“¤ì–´ì˜¬ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.','ì˜¬í•´ëŠ” ì¬ë¬¼ì´ ë“¤ì–´ì˜¬ ì¢‹ì€ ê¸°ìš´ì´ ë³´ì…ë‹ˆë‹¤.','í° ì¬ë¬¼ìš´ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'],
                    love: ['ì—°ì• ìš´ì´ ì•½í•©ë‹ˆë‹¤.','ì–´ëŠ ì •ë„ì˜ ë§Œë‚¨ì´ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.','ì¢‹ì€ ë§Œë‚¨ê³¼ ì¸ì—°ì˜ ê¸°íšŒê°€ ê¸°ëŒ€ë©ë‹ˆë‹¤.','í° ì—°ì• ìš´ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'],
                    health: ['ê±´ê°•ì— ìœ ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.','ê±´ê°•ì— í° ë¬¸ì œê°€ ì—†ì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.','ì „ë°˜ì ìœ¼ë¡œ ê±´ê°•í•œ í•´ê°€ ë  ê²ƒì…ë‹ˆë‹¤.','ë§¤ìš° ì¢‹ì€ ê±´ê°•ìš´ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'],
                    career: ['ì§ì—…ìš´ì´ ì•½í•©ë‹ˆë‹¤.','ì–´ëŠ ì •ë„ì˜ ì„±ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.','ì—…ë¬´ ëŠ¥ë ¥ì´ ì¸ì •ë°›ì„ ì‹œê°„ì…ë‹ˆë‹¤.','í° ë°œì „ê³¼ ìŠ¹ì§„ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'],
                    study: ['í•™ì—…ì— ì§‘ì¤‘ì´ í•„ìš”í•©ë‹ˆë‹¤.','ê¸°ì´ˆë¥¼ ë‹¤ì§€ê¸° ì¢‹ì€ ì‹œê°„ì…ë‹ˆë‹¤.','ì§‘ì¤‘ë ¥ì´ ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤.','ë§¤ìš° ì¢‹ì€ í•™ì—…ìš´ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.']
                },
                // í† ì •ë¹„ê²° ì‹œêµ¬
                fortuneVerses: [
                    { cn: 'æ™‚ä¾†é‹è½‰', meaning: 'ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ìš´ì´ ì¢‹ì•„ì§„ë‹¤. ìƒˆë¡œìš´ ê¸°íšŒê°€ ì°¾ì•„ì˜¬ ê²ƒì…ë‹ˆë‹¤.' },
                    { cn: 'ç¦ç¥¿éš†æ˜Œ', meaning: 'ë³µê³¼ ì¬ë¬¼ì´ ê²¹ì³ì„œ ë²ˆì˜í•œë‹¤. ì˜¬í•´ëŠ” ì¬ë¬¼ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤.' },
                    { cn: 'é¾é¨°è™èº', meaning: 'ìš©ê³¼ í˜¸ë‘ì´ì²˜ëŸ¼ í¬ê²Œ ë›°ì–´ë‚œë‹¤. ì¶”ì§„ë ¥ ìˆëŠ” í™œë™ì´ ì„±ê³µí•©ë‹ˆë‹¤.' },
                    { cn: 'ç™¾èˆ¬å¦‚æ„', meaning: 'ëª¨ë“  ì¼ì´ ëœ»ëŒ€ë¡œ ëœë‹¤. ì›í•˜ëŠ” ê²ƒì„ ì´ë£° ìˆ˜ ìˆëŠ” í•´ì…ë‹ˆë‹¤.' },
                    { cn: 'ç«¹è‹æ¾èŒ‚', meaning: 'ëŒ€ë‚˜ë¬´ì™€ ì†Œë‚˜ë¬´ì²˜ëŸ¼ ì§€ì†ì ìœ¼ë¡œ ë²ˆì˜í•œë‹¤. ì¥ê¸°ì  ê³„íšì´ ì„±ê³µí•©ë‹ˆë‹¤.' },
                    { cn: 'é¢¨èª¿é›¨é †', meaning: 'ë°”ëŒê³¼ ë¹—ì´ ë•Œì— ë§ë‹¤. ë¬´ì—‡ì„ í•˜ë“  í™˜ê²½ì´ ë„ì™€ì¤ë‹ˆë‹¤.' },
                    { cn: 'é‡‘ç‰æ»¿å ‚', meaning: 'ê¸ˆê³¼ ì˜¥ì´ ê°€ë“ ì°¨ë‹¤. ì¬ë¬¼ê³¼ ëª…ì˜ˆê°€ í•¨ê»˜ ë”°ë¦…ë‹ˆë‹¤.' },
                    { cn: 'æ±é¢¨å¹æŸ³', meaning: 'ë™í’ì´ ë²„ë“¤ì„ í”ë“ ë‹¤. ìƒˆë¡œìš´ ë³€í™”ì™€ ê¸°íšŒê°€ ì˜µë‹ˆë‹¤.' },
                    { cn: 'éµ¬ç¨‹è¬é‡Œ', meaning: 'í° ìƒˆê°€ ë©€ë¦¬ ë‚ ì•„ê°„ë‹¤. í° ì„±ê³µê³¼ ë°œì „ì´ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.' },
                    { cn: 'å¤©åœ°åŒå¿ƒ', meaning: 'ì²œì§€ê°€ í•œë§ˆìŒì´ ëœë‹¤. ëª¨ë“  ê²ƒì´ ì¡°í™”ë¡­ê²Œ í˜ëŸ¬ê°‘ë‹ˆë‹¤.' }
                ],
                overallAnalysisTpl: 'ì˜¬í•´ëŠ” ë‹¹ì‹ ì—ê²Œ ìƒˆë¡œìš´ ê¸°íšŒì™€ ë³€í™”ì˜ í•´ê°€ ë  ê²ƒì…ë‹ˆë‹¤. {strengths}ë¥¼ ê°–ì¶˜ ë‹¹ì‹ ì€ ì—¬ëŸ¬ ë¶„ì•¼ì—ì„œ í™œì•½í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.',
                overallAdviceTpl: 'íŠ¹íˆ ìƒë°˜ê¸°ì—ëŠ” ì¬ë¬¼ìš´ì´ ì¢‹ìœ¼ë©°, í•˜ë°˜ê¸°ì—ëŠ” ì¸ê°„ê´€ê³„ê°€ í–¥ìƒë  ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.',
                overallWarningTpl: '{weaknesses}ì— ì£¼ì˜í•˜ì„¸ìš”. ì‹ ì¤‘í•¨ê³¼ ê³„íšì„±ìœ¼ë¡œ ë”ìš± í° ì„±ê³µì„ ì´ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                manAge: 'ë§Œ {age}ì„¸', tradAge: 'ì„¸ëŠ”ë‚˜ì´: {age}ì„¸',
                monthLabel: '{m}ì›”',
                // ì˜¤í–‰ í–‰ë™ì§€ì¹¨
                adviceExcess: 'ê³¼ì‰', adviceDeficiency: 'ê²°í•',
                ohaengBalance: 'âœ¨ ì˜¤í–‰ ê· í˜• ì–‘í˜¸',
                ohaengBalanceDesc: 'ë‹¹ì‹ ì˜ ì˜¤í–‰ì€ ë¹„êµì  ê· í˜• ì¡í˜€ ìˆìŠµë‹ˆë‹¤.',
                elementAdvice: {
                    'æœ¨': { excess: { symptom: 'ê³ ì§‘ì´ ì„¸ê³  ë¶„ë…¸ë¥¼ ì¡°ì ˆí•˜ê¸° ì–´ë ¤ìš°ë©°, ìê¸°ì£¼ì¥ì´ ì§€ë‚˜ì¹˜ê²Œ ê°•í•©ë‹ˆë‹¤.', advice: 'ê¸ˆ(é‡‘) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. í°ìƒ‰/ì€ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ë§¤ìš´ë§› ìŒì‹ì„ ì ì ˆíˆ ì„­ì·¨í•˜ì„¸ìš”.' }, deficiency: { symptom: 'ì˜ì§€ê°€ ë°•ì•½í•˜ê³  ìš°ìœ ë¶€ë‹¨í•˜ë©°, ì‹œì‘ì€ ìˆìœ¼ë‚˜ ëë§ºìŒì´ ì•½í•©ë‹ˆë‹¤.', advice: 'ì´ˆë¡ìƒ‰ ì˜·ì„ ì…ê³ , ì‹ ë§› ë‚˜ëŠ” ìŒì‹(ì‹ì´ˆ, ë ˆëª¬)ì„ ì„­ì·¨í•˜ì„¸ìš”. ì‚°ì±…ì´ë‚˜ ìˆ² ì¹˜ìœ ë¥¼ í†µí•´ ë‚˜ë¬´ì˜ ê¸°ìš´ì„ ë°›ìœ¼ì„¸ìš”.' } },
                    'ç«': { excess: { symptom: 'ê°ì • ê¸°ë³µì´ ì‹¬í•˜ê³  ì„±ê²©ì´ ê¸‰í•˜ë©°, ì‰½ê²Œ í¥ë¶„í•©ë‹ˆë‹¤.', advice: 'ìˆ˜(æ°´) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ê²€ì€ìƒ‰/ë‚¨ìƒ‰ ì˜·ì„ ì…ê³ , ì§ ë§› ìŒì‹(í•´ì¡°ë¥˜, ë¯¸ì—­)ì„ ì„­ì·¨í•˜ì„¸ìš”.' }, deficiency: { symptom: 'ë§¤ì‚¬ì— ì˜ìš•ì´ ì—†ê³  ëƒ‰ì†Œì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.', advice: 'ë¶‰ì€ìƒ‰ ì†Œí’ˆì„ í™œìš©í•˜ê³ , í–‡ë³•ì„ ìì£¼ ì¬ì„¸ìš”. ì“´ë§›(ì»¤í”¼, ë‹¤í¬ì´ˆì½œë¦¿)ì´ ì‹¬ì¥ì„ ê¹¨ì›ë‹ˆë‹¤.' } },
                    'åœŸ': { excess: { symptom: 'ê³ ì§€ì‹í•˜ê³  ìœµí†µì„±ì´ ë¶€ì¡±í•˜ë©°, ë³€í™”ë¥¼ ê·¹ë„ë¡œ êº¼ë¦½ë‹ˆë‹¤.', advice: 'ëª©(æœ¨) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ìƒˆë¡œìš´ ì·¨ë¯¸ë‚˜ ì—¬í–‰ì„ ì‹œì‘í•˜ê³ , ì´ˆë¡ìƒ‰ ì‹ë¬¼ì„ ê°€ê¹Œì´ ë‘ì„¸ìš”.' }, deficiency: { symptom: 'ë¶ˆì•ˆì •í•˜ê³  ëˆê¸°ê°€ ë¶€ì¡±í•˜ë©°, ì£¼ê´€ì´ ì‰½ê²Œ í”ë“¤ë¦½ë‹ˆë‹¤.', advice: 'ë…¸ë€ìƒ‰/ê°ˆìƒ‰ í†¤ì˜ ì˜·ê³¼ ì†Œí’ˆì„ í™œìš©í•˜ì„¸ìš”. ë‹¨ë§›(ê¿€, ê³ êµ¬ë§ˆ)ì„ ì„­ì·¨í•˜ê³ , ê·œì¹™ì ì¸ ìƒí™œ íŒ¨í„´ì„ ìœ ì§€í•˜ì„¸ìš”.' } },
                    'é‡‘': { excess: { symptom: 'ë¹„íŒì ì´ê³  ëƒ‰í˜¹í•˜ë©°, íƒ€ì¸ì— ëŒ€í•œ ê¸°ì¤€ì´ ì§€ë‚˜ì¹˜ê²Œ ë†’ìŠµë‹ˆë‹¤.', advice: 'í™”(ç«) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ë¶‰ì€ìƒ‰ ì†Œí’ˆìœ¼ë¡œ ê°ì„±ì„ ë”í•˜ê³ , ë”°ëœ»í•œ ì‚¬ëŒë“¤ê³¼ì˜ ëª¨ì„ì— ì°¸ì—¬í•˜ì„¸ìš”.' }, deficiency: { symptom: 'ë§ºê³  ëŠìŒì´ ë¶ˆë¶„ëª…í•˜ê³  ìš°ìœ ë¶€ë‹¨í•˜ë©°, ì¼ì˜ ê²°ì‹¤ì´ ì ìŠµë‹ˆë‹¤.', advice: 'í°ìƒ‰/ì€ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ë§¤ìš´ë§› ìŒì‹ì„ ì„­ì·¨í•˜ì„¸ìš”. ì •ë¦¬ì •ëˆ ìŠµê´€ì„ ë“¤ì´ì„¸ìš”.' } },
                    'æ°´': { excess: { symptom: 'ìƒê°ì´ ë„ˆë¬´ ë§ì•„ ìš°ìš¸ê°ì— ë¹ ì§€ê¸° ì‰½ìŠµë‹ˆë‹¤.', advice: 'ë…¸ë€ìƒ‰/ê°ˆìƒ‰ ì˜·ì„ ì…ê³ , í™ì„ ë°Ÿìœ¼ì„¸ìš”. ë‹¨ë§›ì„ ì ì ˆíˆ ì„­ì·¨í•˜ì—¬ ê¸°ë¶„ì„ í™˜ê¸°í•˜ì„¸ìš”.' }, deficiency: { symptom: 'ìœµí†µì„±ì´ ë¶€ì¡±í•˜ê³  ê²ì´ ë§ìœ¼ë©°, ìƒˆë¡œìš´ í™˜ê²½ì— ì ì‘í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.', advice: 'ê²€ì€ìƒ‰/ë‚¨ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ì§ ë§› ìŒì‹(í•´ì¡°ë¥˜)ì„ ì„­ì·¨í•˜ì„¸ìš”. ìˆ˜ë¶„ì„ ì¶©ë¶„íˆ ì„­ì·¨í•˜ì„¸ìš”.' } }
                }
            },
            en: {
                pageTitle: 'Tojeong Bigyeol & Saju - Korean Traditional Fortune Analysis',
                headerTitle: 'Tojeong Bigyeol & Saju',
                headerSubtitle: 'Korean Traditional Fortune Analysis - 2024 Edition',
                loading: 'Calculating your fortune...',
                inputTitle: 'Enter Information',
                labelName: 'Name',
                placeholderName: 'Enter your name',
                labelBirth: 'Date of Birth (Solar)',
                labelBirthTime: 'Birth Time',
                optUnknown: 'Unknown',
                labelGender: 'Gender',
                genderMale: 'Male',
                genderFemale: 'Female',
                labelYear: 'Analysis Year',
                analyzeBtn: 'Analyze Fortune',
                optYear: 'Year', optMonth: 'Month', optDay: 'Day',
                yearUnit: '', monthUnit: '', dayUnit: '',
                timeOptions: [
                    'Unknown',
                    'Ja (23:30~01:29)', 'Chuk (01:30~03:29)', 'In (03:30~05:29)',
                    'Myo (05:30~07:29)', 'Jin (07:30~09:29)', 'Sa (09:30~11:29)',
                    'O (11:30~13:29)', 'Mi (13:30~15:29)', 'Sin (15:30~17:29)',
                    'Yu (17:30~19:29)', 'Sul (19:30~21:29)', 'Hae (21:30~23:29)'
                ],
                secSaju: 'âŠ• Four Pillars Analysis',
                sixtyGapja: 'Sixty Sexagenary Cycle',
                pillarDesc: 'Hover for details | Click Edit to modify pillars',
                pillarYear: 'Year', pillarMonth: 'Month', pillarDay: 'Day', pillarTime: 'Hour',
                tenGan: 'Ten Heavenly Stems (åå¹²)',
                tenGanDesc: '10 Heavenly Stems - representing celestial energy',
                twelveZhi: 'Twelve Earthly Branches (åäºŒæ”¯)',
                twelveZhiDesc: '12 Earthly Branches - representing terrestrial energy (zodiac animals)',
                sajuElements: 'Saju Elements',
                dayMasterLabel: 'Day Master (Day Stem) - the core element representing yourself',
                ageLabel: 'Age',
                zodiacLabel: 'Zodiac (Year Branch)',
                secOhaeng: 'âŠ• Five Elements Analysis',
                ohaengStatus: 'Element Status',
                ohaengGuide: 'ğŸ“Œ Five Elements Tendency Guide',
                thElement: 'Element', thStrong: 'When Strong', thWeak: 'When Weak',
                elWood: 'Wood', elFire: 'Fire', elEarth: 'Earth', elMetal: 'Metal', elWater: 'Water',
                elWoodStrong: 'Proactive, driven, stubborn, anger management issues',
                elWoodWeak: 'Indecisive, weak-willed, starts but doesn\'t finish',
                elFireStrong: 'Passionate, flashy, impatient, mood swings',
                elFireWeak: 'Passive, cynical, lack of expression, low energy',
                elEarthStrong: 'Embracing, trustworthy, inflexible, rigid',
                elEarthWeak: 'Unstable, lack of perseverance, easily swayed',
                elMetalStrong: 'Decisive, loyal, ruthless, critical, obsessive',
                elMetalWeak: 'Unclear boundaries, indecisive, few results',
                elWaterStrong: 'Wise, flexible, overthinks causing delayed action',
                elWaterWeak: 'Inflexible, fearful, poor adaptability',
                customAdvice: 'ğŸ’¡ Personalized Action Guide',
                advicePlaceholder: 'Results will be displayed after analysis.',
                unitCount: '',
                secPersonality: 'âŠ• Personality Analysis',
                labelStrength: 'Strengths', labelWeakness: 'Weaknesses', labelAptitude: 'Aptitude',
                secDaewun: 'âŠ• Lifetime Major Fortune Flow',
                daewunDesc: 'Shows the 10-year cycle fortune flow. Each period represents a major life theme and energy.',
                daewunLabel: 'Decade',
                scoreDescBest: 'Excellent fortune', scoreDescGood: 'Rising fortune',
                scoreDescNormal: 'Average fortune', scoreDescCaution: 'Caution needed',
                fortuneFlow: 'Fortune Flow',
                secTojeong: 'âŠ• Tojeong Bigyeol Fortune',
                upperGua: 'Upper Gua', middleGua: 'Middle Gua', lowerGua: 'Lower Gua',
                yearlyFortune: 'Yearly Fortune', monthlyFortune: 'Monthly Fortune',
                secCategory: 'âŠ• Fortune by Category',
                catWealth: 'Wealth', catLove: 'Love', catHealth: 'Health',
                catCareer: 'Career', catStudy: 'Academic',
                fortuneScore: 'Fortune Score',
                pointUnit: 'pts',
                secOverall: 'âŠ• Overall Summary',
                overallTitle: 'Comprehensive Analysis',
                yearFortuneLabel: 'Overall Fortune',
                secExport: 'âŠ• Share & Export',
                btnCopy: 'ğŸ“‹ Copy Text', btnPrint: 'ğŸ–¨ï¸ Print', btnScreenshot: 'ğŸ“¸ Save Image',
                modalEdit: 'Edit', modalApply: 'Apply', modalCancel: 'Cancel',
                ganTabLabel: 'Heavenly Stems (å¤©å¹²)', zhiTabLabel: 'Earthly Branches (åœ°æ”¯)',
                ganSelectMsg: 'Select a Heavenly Stem', zhiSelectMsg: 'Select an Earthly Branch',
                toastCopyOk: 'Results copied to clipboard!',
                toastCopyFail: 'Copy failed.',
                toastImgGen: 'Generating image...',
                toastImgOk: 'Image saved!',
                toastImgFail: 'Image generation failed. Please use print.',
                toastNoResult: 'No analysis results.',
                toastEdited: 'Saju has been modified!',
                alertInput: 'Please enter your date of birth.',
                personalityDesc: {
                    0: { name: 'ç”² Wood Yang (Gap-mok)', desc: 'Like a great tree, you possess excellent leadership and strong drive.', str: 'Strong will, great leadership, quick judgment', wk: 'Impatience, inflexibility', apt: 'Leadership, business, arts' },
                    1: { name: 'ä¹™ Wood Yin (Eul-mok)', desc: 'Like grass or vines, you are flexible and gentle.', str: 'Flexibility, sensitivity, warmth', wk: 'Indecisiveness, oversensitivity', apt: 'Arts, counseling, education' },
                    2: { name: 'ä¸™ Fire Yang (Byeong-hwa)', desc: 'Like a blazing fire, you are passionate and active.', str: 'Passion, brightness, action', wk: 'Impatience, superficiality', apt: 'Sales, entertainment' },
                    3: { name: 'ä¸ Fire Yin (Jeong-hwa)', desc: 'Like a candle, you are warm and wise.', str: 'Deep thinking, warmth, wisdom', wk: 'Passivity, dependence', apt: 'Academia, culture, counseling' },
                    4: { name: 'æˆŠ Earth Yang (Mu-to)', desc: 'Like a tall mountain, you are stable and trustworthy.', str: 'Reliability, stability, responsibility', wk: 'Rigidity, inflexibility', apt: 'Real estate, finance, management' },
                    5: { name: 'å·± Earth Yin (Gi-to)', desc: 'Like an open field, you are gentle and embracing.', str: 'Embracing, kind, attentive', wk: 'Indecisiveness, lack of resolve', apt: 'HR, welfare, education' },
                    6: { name: 'åºš Metal Yang (Gyeong-geum)', desc: 'Like metal ore, you are straightforward and honest.', str: 'Honesty, strength, decisiveness', wk: 'Stubbornness, coldness', apt: 'Military, police, engineer' },
                    7: { name: 'è¾› Metal Yin (Sin-geum)', desc: 'Like a jewel, you are refined and delicate.', str: 'Delicacy, sharpness, judgment', wk: 'Nervousness, stubbornness', apt: 'Medicine, beauty, science' },
                    8: { name: 'å£¬ Water Yang (Im-su)', desc: 'Like a great river, you are embracing and free.', str: 'Embracing, flexibility, wisdom', wk: 'Indecisiveness, inconsistency', apt: 'Travel, trade, logistics' },
                    9: { name: 'ç™¸ Water Yin (Gye-su)', desc: 'Like dew, you are gentle and perceptive.', str: 'Emotion, delicacy, empathy', wk: 'Timidity, dependence', apt: 'Literature, arts, psychology' }
                },
                fortuneTexts: {
                    wealth: ['Wealth fortune is weak.','Some income is expected.','Good energy for wealth coming in this year.','Great wealth fortune can be expected.'],
                    love: ['Love fortune is weak.','Some new encounters are expected.','Good opportunities for romantic connections.','Great love fortune can be expected.'],
                    health: ['Health needs attention.','No major health concerns expected.','Overall healthy year ahead.','Excellent health fortune expected.'],
                    career: ['Career fortune is weak.','Some achievements can be expected.','Your abilities will be recognized.','Great advancement and promotion expected.'],
                    study: ['Focus needed on studies.','Good time to build foundations.','Period of strong concentration.','Excellent academic fortune expected.']
                },
                fortuneVerses: [
                    { cn: 'æ™‚ä¾†é‹è½‰', meaning: 'Fortune turns with time. New opportunities are coming.' },
                    { cn: 'ç¦ç¥¿éš†æ˜Œ', meaning: 'Blessings and wealth overlap in prosperity. Good wealth fortune this year.' },
                    { cn: 'é¾é¨°è™èº', meaning: 'Soaring like dragons and tigers. Proactive activities lead to success.' },
                    { cn: 'ç™¾èˆ¬å¦‚æ„', meaning: 'All things go as wished. A year to achieve your desires.' },
                    { cn: 'ç«¹è‹æ¾èŒ‚', meaning: 'Flourishing like bamboo and pine. Long-term plans succeed.' },
                    { cn: 'é¢¨èª¿é›¨é †', meaning: 'Wind and rain come in due season. The environment supports you.' },
                    { cn: 'é‡‘ç‰æ»¿å ‚', meaning: 'Gold and jade fill the hall. Wealth and honor follow together.' },
                    { cn: 'æ±é¢¨å¹æŸ³', meaning: 'East wind shakes the willows. New changes and opportunities arrive.' },
                    { cn: 'éµ¬ç¨‹è¬é‡Œ', meaning: 'The great bird flies ten thousand miles. Grand success awaits.' },
                    { cn: 'å¤©åœ°åŒå¿ƒ', meaning: 'Heaven and earth unite as one. Everything flows harmoniously.' }
                ],
                overallAnalysisTpl: 'This year brings new opportunities and changes. With your {strengths}, you can excel in many areas.',
                overallAdviceTpl: 'Especially, wealth fortune is strong in the first half, and relationships improve in the second half.',
                overallWarningTpl: 'Watch out for {weaknesses}. With prudence and planning, greater success awaits.',
                manAge: 'Age {age}', tradAge: 'Korean age: {age}',
                monthLabel: 'Month {m}',
                adviceExcess: 'Excess', adviceDeficiency: 'Deficiency',
                ohaengBalance: 'âœ¨ Five Elements Balanced',
                ohaengBalanceDesc: 'Your five elements are relatively well-balanced.',
                elementAdvice: {
                    'æœ¨': { excess: { symptom: 'Overly stubborn, difficulty controlling anger, too assertive.', advice: 'Supplement with Metal energy. Wear white/silver colors, eat moderately spicy food.' }, deficiency: { symptom: 'Weak-willed, indecisive, starts but doesn\'t finish.', advice: 'Wear green, eat sour foods (vinegar, lemon). Walk in forests to absorb Wood energy.' } },
                    'ç«': { excess: { symptom: 'Extreme mood swings, impatient, easily excited.', advice: 'Supplement with Water energy. Wear black/navy, eat salty foods (seaweed).' }, deficiency: { symptom: 'Lack of motivation, cynical tendencies.', advice: 'Use red accessories, get more sunlight. Bitter tastes (coffee, dark chocolate) awaken the heart.' } },
                    'åœŸ': { excess: { symptom: 'Rigid, inflexible, extremely resistant to change.', advice: 'Supplement with Wood energy. Start new hobbies/travel, keep green plants nearby.' }, deficiency: { symptom: 'Unstable, lack of perseverance, easily swayed.', advice: 'Use yellow/brown clothing and accessories. Eat sweet foods (honey, sweet potato), maintain regular routines.' } },
                    'é‡‘': { excess: { symptom: 'Overly critical, cold, extremely high standards for others.', advice: 'Supplement with Fire energy. Add red accessories for warmth, join social gatherings.' }, deficiency: { symptom: 'Unclear boundaries, indecisive, few accomplishments.', advice: 'Wear white/silver, eat spicy food. Build organizing habits.' } },
                    'æ°´': { excess: { symptom: 'Overthinking leading to depression.', advice: 'Wear yellow/brown, walk barefoot on earth. Eat sweet foods to refresh mood.' }, deficiency: { symptom: 'Inflexible, fearful, poor adaptation to new environments.', advice: 'Wear black/navy, eat salty foods (seaweed). Stay well hydrated.' } }
                }
            }
        };

        function t(key) {
            return I18N[currentLang][key] || I18N['ko'][key] || key;
        }

        function applyI18nToDOM() {
            // ì •ì  data-i18n í…ìŠ¤íŠ¸ êµì²´
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (I18N[currentLang][key]) {
                    el.textContent = I18N[currentLang][key];
                }
            });
            // placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (I18N[currentLang][key]) {
                    el.placeholder = I18N[currentLang][key];
                }
            });
            // í˜ì´ì§€ íƒ€ì´í‹€
            document.getElementById('pageTitle').textContent = t('pageTitle');
            // ì–¸ì–´ ë²„íŠ¼
            document.getElementById('langToggleLabel').textContent = currentLang === 'ko' ? 'ENG' : 'í•œêµ­ì–´';
            // ì‹œê°„ ë“œë¡­ë‹¤ìš´
            const timeSelect = document.getElementById('birthTimeInput');
            const currentTimeVal = timeSelect.value;
            const timeOpts = t('timeOptions');
            for (let i = 0; i < timeSelect.options.length; i++) {
                if (timeOpts[i]) timeSelect.options[i].textContent = timeOpts[i];
            }
            timeSelect.value = currentTimeVal;
            // ìƒë…„ì›”ì¼ ë“œë¡­ë‹¤ìš´ ë‹¨ìœ„
            refreshBirthDropdownLabels();
            // ë¶„ì„ë…„ë„ ë“œë¡­ë‹¤ìš´ (ê°„ì§€ ë¼ë²¨)
            refreshYearDropdownLabels();
            // ëª¨ë‹¬ í…ìŠ¤íŠ¸
            document.getElementById('ganTab').textContent = t('ganTabLabel');
            document.getElementById('zhiTab').textContent = t('zhiTabLabel');
            const ganPanel = document.getElementById('ganSelectorPanel');
            if (ganPanel) ganPanel.querySelector('p').textContent = t('ganSelectMsg');
            const zhiPanel = document.getElementById('zhiSelectorPanel');
            if (zhiPanel) zhiPanel.querySelector('p').textContent = t('zhiSelectMsg');
            // ëª¨ë‹¬ ë²„íŠ¼
            const modalBtns = document.querySelectorAll('.pillar-modal-content .btn-primary');
            modalBtns.forEach(btn => { if (btn.textContent.trim() === 'ì ìš©' || btn.textContent.trim() === 'Apply') btn.textContent = t('modalApply'); });
            const modalCancelBtns = document.querySelectorAll('.pillar-modal-content .btn-secondary');
            modalCancelBtns.forEach(btn => { if (btn.textContent.trim() === 'ì·¨ì†Œ' || btn.textContent.trim() === 'Cancel') btn.textContent = t('modalCancel'); });
        }

        function refreshBirthDropdownLabels() {
            const yearSel = document.getElementById('birthYearSelect');
            const monthSel = document.getElementById('birthMonthSelect');
            const daySel = document.getElementById('birthDaySelect');
            if (yearSel && yearSel.options[0]) yearSel.options[0].textContent = t('optYear');
            if (monthSel && monthSel.options[0]) monthSel.options[0].textContent = t('optMonth');
            if (daySel && daySel.options[0]) daySel.options[0].textContent = t('optDay');
            // ë…„ ë‹¨ìœ„
            for (let i = 1; i < yearSel.options.length; i++) {
                const val = yearSel.options[i].value;
                yearSel.options[i].textContent = currentLang === 'ko' ? val + 'ë…„' : val;
            }
            // ì›” ë‹¨ìœ„
            for (let i = 1; i < monthSel.options.length; i++) {
                const val = parseInt(monthSel.options[i].value);
                monthSel.options[i].textContent = currentLang === 'ko' ? val + 'ì›”' : val;
            }
            // ì¼ ë‹¨ìœ„
            for (let i = 1; i < daySel.options.length; i++) {
                const val = parseInt(daySel.options[i].value);
                daySel.options[i].textContent = currentLang === 'ko' ? val + 'ì¼' : val;
            }
        }

        function refreshYearDropdownLabels() {
            const yearInput = document.getElementById('yearInput');
            for (let i = 0; i < yearInput.options.length; i++) {
                const y = parseInt(yearInput.options[i].value);
                yearInput.options[i].textContent = currentLang === 'ko' ? getGanjiLabel(y) : getGanjiLabelEn(y);
            }
        }

        function getGanjiLabelEn(year) {
            const animals = ['Rat','Ox','Tiger','Rabbit','Dragon','Snake','Horse','Goat','Monkey','Rooster','Dog','Pig'];
            const colors = ['Blue','Blue','Red','Red','Gold','Gold','White','White','Black','Black'];
            const stemIdx = (year - 4) % 10;
            const branchIdx = (year - 4) % 12;
            return `${year} (${colors[stemIdx]} ${animals[branchIdx]})`;
        }

        function toggleLanguage() {
            currentLang = currentLang === 'ko' ? 'en' : 'ko';
            applyI18nToDOM();
            // ì´ë¯¸ ë¶„ì„ëœ ê²°ê³¼ê°€ ìˆìœ¼ë©´ ë‹¤ì‹œ ë Œë”ë§
            if (currentAnalysisData.dayPillar) {
                reanalyzeWithModifiedPillars();
            }
        }

        // ============================================================
        // CONSTANTS AND DATA
        // ============================================================

        const TIAN_GAN = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
        const DI_ZHI = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];

        const TIAN_GAN_KR = [
            { name: 'ê°‘', hanja: 'ç”²', element: 'ëª©(æœ¨)', yinyang: 'ì–‘(é™½)', meaning: 'í° ë‚˜ë¬´, ì‹œì‘ê³¼ ì„±ì¥', color: '#4CAF50' },
            { name: 'ì„', hanja: 'ä¹™', element: 'ëª©(æœ¨)', yinyang: 'ìŒ(é™°)', meaning: 'í’€, ìœ ì—°í•¨ê³¼ ì ì‘', color: '#81C784' },
            { name: 'ë³‘', hanja: 'ä¸™', element: 'í™”(ç«)', yinyang: 'ì–‘(é™½)', meaning: 'íƒœì–‘, ì—´ì •ê³¼ ë°ìŒ', color: '#F44336' },
            { name: 'ì •', hanja: 'ä¸', element: 'í™”(ç«)', yinyang: 'ìŒ(é™°)', meaning: 'ì´›ë¶ˆ, ì§€í˜œì™€ ì˜¨ê¸°', color: '#EF5350' },
            { name: 'ë¬´', hanja: 'æˆŠ', element: 'í† (åœŸ)', yinyang: 'ì–‘(é™½)', meaning: 'í° ì‚°, ì•ˆì •ê³¼ ì‹ ë¢°', color: '#FFC107' },
            { name: 'ê¸°', hanja: 'å·±', element: 'í† (åœŸ)', yinyang: 'ìŒ(é™°)', meaning: 'ë“¤íŒ, í¬ìš©ê³¼ ë°°ë ¤', color: '#FFB74D' },
            { name: 'ê²½', hanja: 'åºš', element: 'ê¸ˆ(é‡‘)', yinyang: 'ì–‘(é™½)', meaning: 'ì‡ , ê°•ì¸í•¨ê³¼ ê²°ë‹¨', color: '#BDBDBD' },
            { name: 'ì‹ ', hanja: 'è¾›', element: 'ê¸ˆ(é‡‘)', yinyang: 'ìŒ(é™°)', meaning: 'ë³´ì„, ì„¬ì„¸í•¨ê³¼ ì˜ˆë¦¬', color: '#9E9E9E' },
            { name: 'ì„', hanja: 'å£¬', element: 'ìˆ˜(æ°´)', yinyang: 'ì–‘(é™½)', meaning: 'í° ê°•, ì§€í˜œì™€ í¬ìš©', color: '#2196F3' },
            { name: 'ê³„', hanja: 'ç™¸', element: 'ìˆ˜(æ°´)', yinyang: 'ìŒ(é™°)', meaning: 'ì´ìŠ¬, ê°ì„±ê³¼ ì§ê´€', color: '#64B5F6' }
        ];

        const DI_ZHI_KR = [
            { name: 'ì', hanja: 'å­', animal: 'ì¥(é¼ )', element: 'ìˆ˜(æ°´)', time: '23:00~01:00', meaning: 'ì§€í˜œì™€ ë¯¼ì²©' },
            { name: 'ì¶•', hanja: 'ä¸‘', animal: 'ì†Œ(ç‰›)', element: 'í† (åœŸ)', time: '01:00~03:00', meaning: 'ì„±ì‹¤ê³¼ ì¸ë‚´' },
            { name: 'ì¸', hanja: 'å¯…', animal: 'í˜¸ë‘ì´(è™)', element: 'ëª©(æœ¨)', time: '03:00~05:00', meaning: 'ìš©ë§¹ê³¼ ê²°ë‹¨' },
            { name: 'ë¬˜', hanja: 'å¯', animal: 'í† ë¼(å…”)', element: 'ëª©(æœ¨)', time: '05:00~07:00', meaning: 'ì˜¨í™”ì™€ ê¸°ë¯¼' },
            { name: 'ì§„', hanja: 'è¾°', animal: 'ìš©(é¾)', element: 'í† (åœŸ)', time: '07:00~09:00', meaning: 'ê¶Œìœ„ì™€ ë³€í™”' },
            { name: 'ì‚¬', hanja: 'å·³', animal: 'ë±€(è›‡)', element: 'í™”(ç«)', time: '09:00~11:00', meaning: 'ì§€í˜œì™€ í†µì°°' },
            { name: 'ì˜¤', hanja: 'åˆ', animal: 'ë§(é¦¬)', element: 'í™”(ç«)', time: '11:00~13:00', meaning: 'ì—´ì •ê³¼ í™œë ¥' },
            { name: 'ë¯¸', hanja: 'æœª', animal: 'ì–‘(ç¾Š)', element: 'í† (åœŸ)', time: '13:00~15:00', meaning: 'í‰í™”ì™€ ì˜ˆìˆ ' },
            { name: 'ì‹ ', hanja: 'ç”³', animal: 'ì›ìˆ­ì´(çŒ´)', element: 'ê¸ˆ(é‡‘)', time: '15:00~17:00', meaning: 'ì¬ì¹˜ì™€ ì˜ë¦¬' },
            { name: 'ìœ ', hanja: 'é…‰', animal: 'ë‹­(é·„)', element: 'ê¸ˆ(é‡‘)', time: '17:00~19:00', meaning: 'ì •í™•ê³¼ ê·¼ë©´' },
            { name: 'ìˆ ', hanja: 'æˆŒ', animal: 'ê°œ(çŠ¬)', element: 'í† (åœŸ)', time: '19:00~21:00', meaning: 'ì¶©ì„±ê³¼ ì˜ë¦¬' },
            { name: 'í•´', hanja: 'äº¥', animal: 'ë¼ì§€(è±¬)', element: 'ìˆ˜(æ°´)', time: '21:00~23:00', meaning: 'ë³µê³¼ í’ìš”' }
        ];

        const ELEMENTS = {
            gan: {
                0: 'æœ¨', 1: 'æœ¨', 2: 'ç«', 3: 'ç«', 4: 'åœŸ', 5: 'åœŸ', 6: 'é‡‘', 7: 'é‡‘', 8: 'æ°´', 9: 'æ°´'
            },
            zhi: {
                0: 'æ°´', 1: 'åœŸ', 2: 'æœ¨', 3: 'æœ¨', 4: 'åœŸ', 5: 'ç«', 6: 'ç«', 7: 'åœŸ',
                8: 'é‡‘', 9: 'é‡‘', 10: 'åœŸ', 11: 'æ°´'
            }
        };

        const ELEMENT_NAMES = {
            'æœ¨': 'ëª©(Wood)', 'ç«': 'í™”(Fire)', 'åœŸ': 'í† (Earth)', 'é‡‘': 'ê¸ˆ(Metal)', 'æ°´': 'ìˆ˜(Water)'
        };

        const ELEMENT_COLORS = {
            'æœ¨': '#4CAF50', 'ç«': '#F44336', 'åœŸ': '#FFC107', 'é‡‘': '#BDBDBD', 'æ°´': '#2196F3'
        };

        // ===== ê°„ì§€ ë…„ë„ í‘œì‹œìš© ë°ì´í„° =====
        const GANJI_STEMS_KR = ['ê°‘', 'ì„', 'ë³‘', 'ì •', 'ë¬´', 'ê¸°', 'ê²½', 'ì‹ ', 'ì„', 'ê³„'];
        const GANJI_BRANCHES_KR = ['ì', 'ì¶•', 'ì¸', 'ë¬˜', 'ì§„', 'ì‚¬', 'ì˜¤', 'ë¯¸', 'ì‹ ', 'ìœ ', 'ìˆ ', 'í•´'];
        const GANJI_ANIMALS = ['ì¥', 'ì†Œ', 'í˜¸ë‘ì´', 'í† ë¼', 'ìš©', 'ë±€', 'ë§', 'ì–‘', 'ì›ìˆ­ì´', 'ë‹­', 'ê°œ', 'ë¼ì§€'];
        const GANJI_COLORS = ['í‘¸ë¥¸', 'í‘¸ë¥¸', 'ë¶‰ì€', 'ë¶‰ì€', 'í™©ê¸ˆ', 'í™©ê¸ˆ', 'í•˜ì–€', 'í•˜ì–€', 'ê²€ì€', 'ê²€ì€'];

        function getGanjiLabel(year) {
            const stemIdx = (year - 4) % 10;
            const branchIdx = (year - 4) % 12;
            return `${year}ë…„ (${GANJI_STEMS_KR[stemIdx]}${GANJI_BRANCHES_KR[branchIdx]}ë…„ - ${GANJI_COLORS[stemIdx]} ${GANJI_ANIMALS[branchIdx]})`;
        }

        const REFERENCE_DATE = new Date(1979, 3, 5);
        const REFERENCE_GAN = 6;
        const REFERENCE_ZHI = 6;

        const FORTUNE_VERSES = [
            { cn: 'æ™‚ä¾†é‹è½‰', meaning: 'ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ìš´ì´ ì¢‹ì•„ì§„ë‹¤. ìƒˆë¡œìš´ ê¸°íšŒê°€ ì°¾ì•„ì˜¬ ê²ƒì…ë‹ˆë‹¤.' },
            { cn: 'ç¦ç¥¿éš†æ˜Œ', meaning: 'ë³µê³¼ ì¬ë¬¼ì´ ê²¹ì³ì„œ ë²ˆì˜í•œë‹¤. ì˜¬í•´ëŠ” ì¬ë¬¼ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤.' },
            { cn: 'é¾é¨°è™èº', meaning: 'ìš©ê³¼ í˜¸ë‘ì´ì²˜ëŸ¼ í¬ê²Œ ë›°ì–´ë‚œë‹¤. ì¶”ì§„ë ¥ ìˆëŠ” í™œë™ì´ ì„±ê³µí•©ë‹ˆë‹¤.' },
            { cn: 'ç™¾èˆ¬å¦‚æ„', meaning: 'ëª¨ë“  ì¼ì´ ëœ»ëŒ€ë¡œ ëœë‹¤. ì›í•˜ëŠ” ê²ƒì„ ì´ë£° ìˆ˜ ìˆëŠ” í•´ì…ë‹ˆë‹¤.' },
            { cn: 'ç«¹è‹æ¾èŒ‚', meaning: 'ëŒ€ë‚˜ë¬´ì™€ ì†Œë‚˜ë¬´ì²˜ëŸ¼ ì§€ì†ì ìœ¼ë¡œ ë²ˆì˜í•œë‹¤. ì¥ê¸°ì  ê³„íšì´ ì„±ê³µí•©ë‹ˆë‹¤.' },
            { cn: 'é¢¨èª¿é›¨é †', meaning: 'ë°”ëŒê³¼ ë¹—ì´ ë•Œì— ë§ë‹¤. ë¬´ì—‡ì„ í•˜ë“  í™˜ê²½ì´ ë„ì™€ì¤ë‹ˆë‹¤.' },
            { cn: 'é‡‘ç‰æ»¿å ‚', meaning: 'ê¸ˆê³¼ ì˜¥ì´ ê°€ë“ ì°¨ë‹¤. ì¬ë¬¼ê³¼ ëª…ì˜ˆê°€ í•¨ê»˜ ë”°ë¦…ë‹ˆë‹¤.' },
            { cn: 'æ±é¢¨å¹æŸ³', meaning: 'ë™í’ì´ ë²„ë“¤ì„ í”ë“ ë‹¤. ìƒˆë¡œìš´ ë³€í™”ì™€ ê¸°íšŒê°€ ì˜µë‹ˆë‹¤.' },
            { cn: 'éµ¬ç¨‹è¬é‡Œ', meaning: 'í° ìƒˆê°€ ë©€ë¦¬ ë‚ ì•„ê°„ë‹¤. í° ì„±ê³µê³¼ ë°œì „ì´ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.' },
            { cn: 'å¤©åœ°åŒå¿ƒ', meaning: 'ì²œì§€ê°€ í•œë§ˆìŒì´ ëœë‹¤. ëª¨ë“  ê²ƒì´ ì¡°í™”ë¡­ê²Œ í˜ëŸ¬ê°‘ë‹ˆë‹¤.' }
        ];

        const PERSONALITIES = {
            0: {
                name: 'ç”²æœ¨(ê°‘ëª©)',
                desc: 'í° ë‚˜ë¬´ë¥¼ ì˜ë¯¸í•˜ëŠ” ì–‘ëª©ìœ¼ë¡œ, ë‹¹ì‹ ì€ íƒì›”í•œ ì§€ë„ë ¥ê³¼ ê°•í•œ ì¶”ì§„ë ¥ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.',
                strengths: 'ê°•í•œ ì˜ì§€ë ¥, ë›°ì–´ë‚œ ì§€ë„ë ¥, ë¹ ë¥¸ íŒë‹¨ë ¥',
                weaknesses: 'ì„±ê¸‰í•¨, ìœµí†µì„± ë¶€ì¡±',
                aptitude: 'ë¦¬ë”ì‹­, ì‚¬ì—…, ì˜ˆìˆ '
            },
            1: {
                name: 'ä¹™æœ¨(ì„ëª©)',
                desc: 'ì‘ì€ í’€ì´ë‚˜ ë©êµ´ì„ ì˜ë¯¸í•˜ëŠ” ìŒëª©ìœ¼ë¡œ, ìœ ì—°í•˜ê³  ì˜¨í™”í•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ìœ ì—°ì„±, ê°ìˆ˜ì„±, ë”°ëœ»í•¨',
                weaknesses: 'ìš°ìœ ë¶€ë‹¨í•¨, ê³¼ë¯¼í•¨',
                aptitude: 'ì˜ˆìˆ , ìƒë‹´, êµìœ¡'
            },
            2: {
                name: 'ä¸™ç«(ë³‘í™”)',
                desc: 'íƒ€ì˜¤ë¥´ëŠ” í° ë¶ˆì„ ì˜ë¯¸í•˜ëŠ” ì–‘í™”ë¡œ, ì—´ì •ì ì´ê³  í™œë°œí•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ì—´ì •, ë°ìŒ, í–‰ë™ë ¥',
                weaknesses: 'ì„±ê¸‰í•¨, í”¼ìƒì„±',
                aptitude: 'ì˜ì—…, ì—”í„°í…Œì¸ë¨¼íŠ¸'
            },
            3: {
                name: 'ä¸ç«(ì •í™”)',
                desc: 'ì´›ë¶ˆì´ë‚˜ ì‘ì€ ë¶ˆì„ ì˜ë¯¸í•˜ëŠ” ìŒí™”ë¡œ, ì˜¨í™”í•˜ê³  ëª…ì§€í•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ê¹Šì€ ì‚¬ê³ , ë”°ëœ»í•¨, ì§€í˜œ',
                weaknesses: 'ì†Œê·¹ì„±, ì˜ì¡´ì„±',
                aptitude: 'í•™ë¬¸, ë¬¸í™”, ìƒë‹´'
            },
            4: {
                name: 'æˆŠåœŸ(ë¬´í† )',
                desc: 'ë†’ì€ ì‚°ì„ ì˜ë¯¸í•˜ëŠ” ì–‘í† ë¡œ, ì•ˆì •ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ì‹ ë¢°ì„±, ì•ˆì •ì„±, ì±…ì„ê°',
                weaknesses: 'ê²½ì§ë¨, ìœ ì—°ì„± ë¶€ì¡±',
                aptitude: 'ë¶€ë™ì‚°, ê¸ˆìœµ, ê´€ë¦¬'
            },
            5: {
                name: 'å·±åœŸ(ê¸°í† )',
                desc: 'ë‚®ì€ ë“¤íŒì„ ì˜ë¯¸í•˜ëŠ” ìŒí† ë¡œ, ë¶€ë“œëŸ½ê³  í¬ìš©ë ¥ì´ ìˆëŠ” ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'í¬ìš©ë ¥, ì¹œì ˆí•¨, ì„¸ì‹¬í•¨',
                weaknesses: 'ìš°ìœ ë¶€ë‹¨í•¨, ê²°ë‹¨ë ¥ ë¶€ì¡±',
                aptitude: 'HR, ë³µì§€, êµìœ¡'
            },
            6: {
                name: 'åºšé‡‘(ê²½ê¸ˆ)',
                desc: 'ê´‘ë¬¼ì´ë‚˜ í° ì¹¼ì„ ì˜ë¯¸í•˜ëŠ” ì–‘ê¸ˆìœ¼ë¡œ, ì§ì„ ì ì´ê³  ì •ì§í•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ì •ì§í•¨, ê°•ì¸í•¨, ê²°ë‹¨ë ¥',
                weaknesses: 'ì™„ê³ í•¨, ëƒ‰ì •í•¨',
                aptitude: 'êµ°ì¸, ê²½ì°°, ê¸°ìˆ ì'
            },
            7: {
                name: 'è¾›é‡‘(ì‹ ê¸ˆ)',
                desc: 'ë³´ì„ì´ë‚˜ ì‘ì€ ì¹¼ì„ ì˜ë¯¸í•˜ëŠ” ìŒê¸ˆìœ¼ë¡œ, ì •êµí•˜ê³  ì„¬ì„¸í•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ì„¬ì„¸í•¨, ì˜ˆë¦¬í•¨, íŒë‹¨ë ¥',
                weaknesses: 'ì‹ ê²½ê³¼ë¯¼, ê³ ì§‘',
                aptitude: 'ì˜ë£Œ, ë¯¸ìš©, ê³¼í•™'
            },
            8: {
                name: 'å£¬æ°´(ì„ìˆ˜)',
                desc: 'í° ê°•ì´ë‚˜ ë°”ë‹¤ë¥¼ ì˜ë¯¸í•˜ëŠ” ì–‘ìˆ˜ë¡œ, í¬ìš©ë ¥ì´ í¬ê³  ììœ ë¡œìš´ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'í¬ìš©ë ¥, ìœ ì—°ì„±, ì§€í˜œ',
                weaknesses: 'ìš°ìœ ë¶€ë‹¨í•¨, ì¼ê´€ì„± ë¶€ì¡±',
                aptitude: 'ì—¬í–‰, ë¬´ì—­, ìœ í†µ'
            },
            9: {
                name: 'ç™¸æ°´(ê³„ìˆ˜)',
                desc: 'ì´ìŠ¬ì´ë‚˜ ë¹—ì„ ì˜ë¯¸í•˜ëŠ” ìŒìˆ˜ë¡œ, ë¶€ë“œëŸ½ê³  ì˜ˆë¯¼í•œ ì„±ê²©ì…ë‹ˆë‹¤.',
                strengths: 'ê°ì„±, ì„¬ì„¸í•¨, ê³µê°ë ¥',
                weaknesses: 'ì†Œì‹¬í•¨, ì˜ì¡´ì„±',
                aptitude: 'ë¬¸í•™, ì˜ˆìˆ , ì‹¬ë¦¬í•™'
            }
        };

        const ELEMENT_ADVICE = {
            'æœ¨': {
                name: 'ëª©(æœ¨)',
                icon: 'ğŸŒ³',
                color: '#81c784',
                bgColor: 'rgba(76, 175, 80, 0.1)',
                borderColor: 'rgba(76, 175, 80, 0.4)',
                excess: {
                    label: 'ê³¼ì‰',
                    symptom: 'ê³ ì§‘ì´ ì„¸ê³  ë¶„ë…¸ë¥¼ ì¡°ì ˆí•˜ê¸° ì–´ë ¤ìš°ë©°, ìê¸°ì£¼ì¥ì´ ì§€ë‚˜ì¹˜ê²Œ ê°•í•©ë‹ˆë‹¤.',
                    advice: 'ê¸ˆ(é‡‘) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. í°ìƒ‰/ì€ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ë§¤ìš´ë§› ìŒì‹ì„ ì ì ˆíˆ ì„­ì·¨í•˜ì„¸ìš”.'
                },
                deficiency: {
                    label: 'ê²°í•',
                    symptom: 'ì˜ì§€ê°€ ë°•ì•½í•˜ê³  ìš°ìœ ë¶€ë‹¨í•˜ë©°, ì‹œì‘ì€ ìˆìœ¼ë‚˜ ëë§ºìŒì´ ì•½í•©ë‹ˆë‹¤.',
                    advice: 'ì´ˆë¡ìƒ‰ ì˜·ì„ ì…ê³ , ì‹ ë§› ë‚˜ëŠ” ìŒì‹(ì‹ì´ˆ, ë ˆëª¬)ì„ ì„­ì·¨í•˜ì„¸ìš”. ì‚°ì±…ì´ë‚˜ ìˆ² ì¹˜ìœ ë¥¼ í†µí•´ ë‚˜ë¬´ì˜ ê¸°ìš´ì„ ë°›ìœ¼ì„¸ìš”.'
                }
            },
            'ç«': {
                name: 'í™”(ç«)',
                icon: 'ğŸ”¥',
                color: '#ef5350',
                bgColor: 'rgba(244, 67, 54, 0.1)',
                borderColor: 'rgba(244, 67, 54, 0.4)',
                excess: {
                    label: 'ê³¼ì‰',
                    symptom: 'ê°ì • ê¸°ë³µì´ ì‹¬í•˜ê³  ì„±ê²©ì´ ê¸‰í•˜ë©°, ì‰½ê²Œ í¥ë¶„í•©ë‹ˆë‹¤.',
                    advice: 'ìˆ˜(æ°´) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ê²€ì€ìƒ‰/ë‚¨ìƒ‰ ì˜·ì„ ì…ê³ , ì§ ë§› ìŒì‹(í•´ì¡°ë¥˜, ë¯¸ì—­)ì„ ì„­ì·¨í•˜ì„¸ìš”.'
                },
                deficiency: {
                    label: 'ê²°í•',
                    symptom: 'ë§¤ì‚¬ì— ì˜ìš•ì´ ì—†ê³  ëƒ‰ì†Œì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                    advice: 'ë¶‰ì€ìƒ‰ ì†Œí’ˆì„ í™œìš©í•˜ê³ , í–‡ë³•ì„ ìì£¼ ì¬ì„¸ìš”. ì“´ë§›(ì»¤í”¼, ë‹¤í¬ì´ˆì½œë¦¿)ì´ ì‹¬ì¥ì„ ê¹¨ì›ë‹ˆë‹¤.'
                }
            },
            'åœŸ': {
                name: 'í† (åœŸ)',
                icon: 'â›°ï¸',
                color: '#ffb74d',
                bgColor: 'rgba(255, 193, 7, 0.1)',
                borderColor: 'rgba(255, 193, 7, 0.4)',
                excess: {
                    label: 'ê³¼ì‰',
                    symptom: 'ê³ ì§€ì‹í•˜ê³  ìœµí†µì„±ì´ ë¶€ì¡±í•˜ë©°, ë³€í™”ë¥¼ ê·¹ë„ë¡œ êº¼ë¦½ë‹ˆë‹¤.',
                    advice: 'ëª©(æœ¨) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ìƒˆë¡œìš´ ì·¨ë¯¸ë‚˜ ì—¬í–‰ì„ ì‹œì‘í•˜ê³ , ì´ˆë¡ìƒ‰ ì‹ë¬¼ì„ ê°€ê¹Œì´ ë‘ì„¸ìš”.'
                },
                deficiency: {
                    label: 'ê²°í•',
                    symptom: 'ë¶ˆì•ˆì •í•˜ê³  ëˆê¸°ê°€ ë¶€ì¡±í•˜ë©°, ì£¼ê´€ì´ ì‰½ê²Œ í”ë“¤ë¦½ë‹ˆë‹¤.',
                    advice: 'ë…¸ë€ìƒ‰/ê°ˆìƒ‰ í†¤ì˜ ì˜·ê³¼ ì†Œí’ˆì„ í™œìš©í•˜ì„¸ìš”. ë‹¨ë§›(ê¿€, ê³ êµ¬ë§ˆ)ì„ ì„­ì·¨í•˜ê³ , ê·œì¹™ì ì¸ ìƒí™œ íŒ¨í„´ì„ ìœ ì§€í•˜ì„¸ìš”.'
                }
            },
            'é‡‘': {
                name: 'ê¸ˆ(é‡‘)',
                icon: 'âš”ï¸',
                color: '#bdbdbd',
                bgColor: 'rgba(189, 189, 189, 0.1)',
                borderColor: 'rgba(189, 189, 189, 0.4)',
                excess: {
                    label: 'ê³¼ì‰',
                    symptom: 'ë¹„íŒì ì´ê³  ëƒ‰í˜¹í•˜ë©°, íƒ€ì¸ì— ëŒ€í•œ ê¸°ì¤€ì´ ì§€ë‚˜ì¹˜ê²Œ ë†’ìŠµë‹ˆë‹¤.',
                    advice: 'í™”(ç«) ê¸°ìš´ì„ ë³´ì¶©í•˜ì„¸ìš”. ë¶‰ì€ìƒ‰ ì†Œí’ˆìœ¼ë¡œ ê°ì„±ì„ ë”í•˜ê³ , ë”°ëœ»í•œ ì‚¬ëŒë“¤ê³¼ì˜ ëª¨ì„ì— ì°¸ì—¬í•˜ì„¸ìš”.'
                },
                deficiency: {
                    label: 'ê²°í•',
                    symptom: 'ë§ºê³  ëŠìŒì´ ë¶ˆë¶„ëª…í•˜ê³  ìš°ìœ ë¶€ë‹¨í•˜ë©°, ì¼ì˜ ê²°ì‹¤ì´ ì ìŠµë‹ˆë‹¤.',
                    advice: 'í°ìƒ‰/ì€ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ë§¤ìš´ë§› ìŒì‹ì„ ì„­ì·¨í•˜ì„¸ìš”. ì •ë¦¬ì •ëˆ ìŠµê´€ì„ ë“¤ì´ì„¸ìš”.'
                }
            },
            'æ°´': {
                name: 'ìˆ˜(æ°´)',
                icon: 'ğŸ’§',
                color: '#64b5f6',
                bgColor: 'rgba(33, 150, 243, 0.1)',
                borderColor: 'rgba(33, 150, 243, 0.4)',
                excess: {
                    label: 'ê³¼ì‰',
                    symptom: 'ìƒê°ì´ ë„ˆë¬´ ë§ì•„ ìš°ìš¸ê°ì— ë¹ ì§€ê¸° ì‰½ìŠµë‹ˆë‹¤.',
                    advice: 'ë…¸ë€ìƒ‰/ê°ˆìƒ‰ ì˜·ì„ ì…ê³ , í™ì„ ë°Ÿìœ¼ì„¸ìš”. ë‹¨ë§›ì„ ì ì ˆíˆ ì„­ì·¨í•˜ì—¬ ê¸°ë¶„ì„ í™˜ê¸°í•˜ì„¸ìš”.'
                },
                deficiency: {
                    label: 'ê²°í•',
                    symptom: 'ìœµí†µì„±ì´ ë¶€ì¡±í•˜ê³  ê²ì´ ë§ìœ¼ë©°, ìƒˆë¡œìš´ í™˜ê²½ì— ì ì‘í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.',
                    advice: 'ê²€ì€ìƒ‰/ë‚¨ìƒ‰ ê³„ì—´ ì˜·ì„ ì…ê³ , ì§ ë§› ìŒì‹(í•´ì¡°ë¥˜)ì„ ì„­ì·¨í•˜ì„¸ìš”. ìˆ˜ë¶„ì„ ì¶©ë¶„íˆ ì„­ì·¨í•˜ì„¸ìš”.'
                }
            }
        };

        // ============================================================
        // UTILITY FUNCTIONS
        // ============================================================

        function getDaysDifference(date1, date2) {
            const time1 = Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate());
            const time2 = Date.UTC(date2.getFullYear(), date2.getMonth(), date2.getDate());
            return Math.round((time1 - time2) / (1000 * 60 * 60 * 24));
        }

        function calculateDayPillar(date) {
            const daysDiff = getDaysDifference(date, REFERENCE_DATE);
            const ganIdx = ((REFERENCE_GAN + daysDiff) % 10 + 10) % 10;
            const zhiIdx = ((REFERENCE_ZHI + daysDiff) % 12 + 12) % 12;
            return { gan: ganIdx, zhi: zhiIdx };
        }

        function calculateYearPillar(date) {
            let year = date.getFullYear();
            let month = date.getMonth() + 1;
            let day = date.getDate();

            const lichunMonth = 2;
            const lichunDay = 4;

            if (month < lichunMonth || (month === lichunMonth && day < lichunDay)) {
                year--;
            }

            const yearDiff = year - 1984;
            const ganIdx = ((yearDiff) % 10 + 10) % 10;
            const zhiIdx = ((yearDiff) % 12 + 12) % 12;

            return { gan: ganIdx, zhi: zhiIdx };
        }

        function calculateMonthPillar(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();

            const MONTH_BOUNDARIES = [
                { m: 2,  d: 4,  zhi: 2 },
                { m: 3,  d: 6,  zhi: 3 },
                { m: 4,  d: 6,  zhi: 4 },
                { m: 5,  d: 6,  zhi: 5 },
                { m: 6,  d: 6,  zhi: 6 },
                { m: 7,  d: 7,  zhi: 7 },
                { m: 8,  d: 7,  zhi: 8 },
                { m: 9,  d: 8,  zhi: 9 },
                { m: 10, d: 8,  zhi: 10 },
                { m: 11, d: 7,  zhi: 11 },
                { m: 12, d: 7,  zhi: 0 },
                { m: 1,  d: 6,  zhi: 1 }
            ];

            let monthZhi = -1;
            let monthOrder = -1;

            for (let i = 0; i < MONTH_BOUNDARIES.length; i++) {
                const curr = MONTH_BOUNDARIES[i];
                const next = MONTH_BOUNDARIES[(i + 1) % MONTH_BOUNDARIES.length];

                let inRange = false;

                if (curr.m < next.m) {
                    if (month === curr.m && day >= curr.d) inRange = true;
                    else if (month > curr.m && month < next.m) inRange = true;
                    else if (month === next.m && day < next.d) inRange = true;
                } else {
                    if (month === curr.m && day >= curr.d) inRange = true;
                    else if (month > curr.m) inRange = true;
                    else if (month < next.m) inRange = true;
                    else if (month === next.m && day < next.d) inRange = true;
                }

                if (inRange) {
                    monthZhi = curr.zhi;
                    monthOrder = i;
                    break;
                }
            }

            if (monthZhi === -1) {
                monthZhi = 2;
                monthOrder = 0;
            }

            const yearGan = calculateYearPillar(date).gan;
            const ganStartForYinMonth = ((yearGan % 5) * 2 + 2) % 10;
            const monthGan = (ganStartForYinMonth + monthOrder) % 10;

            return { gan: monthGan, zhi: monthZhi };
        }

        function calculateTimePillar(date, timeIndex) {
            if (timeIndex === '' || timeIndex === undefined) {
                return { gan: -1, zhi: -1 };
            }

            const dayPillar = calculateDayPillar(date);
            const dayGan = dayPillar.gan;

            let timeGanStart;
            switch (dayGan) {
                case 0: case 5: timeGanStart = 0; break;
                case 1: case 6: timeGanStart = 2; break;
                case 2: case 7: timeGanStart = 4; break;
                case 3: case 8: timeGanStart = 6; break;
                case 4: case 9: timeGanStart = 8; break;
                default: timeGanStart = 0;
            }

            const timeGan = (timeGanStart + parseInt(timeIndex)) % 10;
            const timeZhi = parseInt(timeIndex);

            return { gan: timeGan, zhi: timeZhi };
        }

        function calculateKoreanAge(birthDate, referenceDate) {
            const birthYear = birthDate.getFullYear();
            const refYear = referenceDate.getFullYear();
            let age = refYear - birthYear;
            const refMonth = referenceDate.getMonth();
            const birthMonth = birthDate.getMonth();
            const refDay = referenceDate.getDate();
            const birthDay = birthDate.getDate();
            if (refMonth < birthMonth || (refMonth === birthMonth && refDay < birthDay)) {
                age--;
            }
            if (age < 0) age = 0;
            return age;
        }

        function calculateTraditionalKoreanAge(birthDate, referenceDate) {
            const birthYear = birthDate.getFullYear();
            const refYear = referenceDate.getFullYear();
            let age = refYear - birthYear + 1;
            if (age < 1) age = 1;
            return age;
        }

        function calculateTojeongBigyeol(birthDate, referenceDate) {
            const age = calculateTraditionalKoreanAge(birthDate, referenceDate);
            const month = birthDate.getMonth() + 1;
            const day = birthDate.getDate();

            let upperGua = age % 8;
            if (upperGua === 0) upperGua = 8;

            let middleGua = (upperGua + month) % 6;
            if (middleGua === 0) middleGua = 6;

            let lowerGua = (middleGua + day) % 3;
            if (lowerGua === 0) lowerGua = 3;

            return { upper: upperGua, middle: middleGua, lower: lowerGua };
        }

        function hexagramToYinYang(lineIndex, guaNumber) {
            return (guaNumber + lineIndex) % 2 === 0;
        }

        function getFortuneVerse(index) {
            return FORTUNE_VERSES[index % FORTUNE_VERSES.length];
        }

        function countElements(pillars) {
            const counts = { 'æœ¨': 0, 'ç«': 0, 'åœŸ': 0, 'é‡‘': 0, 'æ°´': 0 };

            pillars.forEach(pillar => {
                if (pillar.gan >= 0) {
                    const element = ELEMENTS.gan[pillar.gan];
                    counts[element]++;
                }
                if (pillar.zhi >= 0) {
                    const element = ELEMENTS.zhi[pillar.zhi];
                    counts[element]++;
                }
            });

            return counts;
        }

        // âœ… FIXED: í•¨ìˆ˜ë“¤ì„ ì‚¬ìš© ì „ì— ì •ì˜
        function getScoreDescription(score) {
            if (score >= 80) return t('scoreDescBest');
            if (score >= 60) return t('scoreDescGood');
            if (score >= 40) return t('scoreDescNormal');
            return t('scoreDescCaution');
        }

        function calculateDaewunList(gender, yearGanIndex, monthGanIndex, monthZhiIndex) {
            const isYearGanYang = (yearGanIndex % 2 === 0);
            let direction = 1;
            
            if (gender === 'male') {
                direction = isYearGanYang ? 1 : -1;
            } else {
                direction = isYearGanYang ? -1 : 1;
            }
        
            const daewunList = [];
            
            for (let i = 1; i <= 9; i++) {
                let nextGan = (monthGanIndex + (direction * i)) % 10;
                let nextZhi = (monthZhiIndex + (direction * i)) % 12;
        
                if (nextGan < 0) nextGan += 10;
                if (nextZhi < 0) nextZhi += 12;
        
                daewunList.push({
                    gan: nextGan,
                    zhi: nextZhi
                });
            }
            return daewunList;
        }
        
        function calculateSajuStrengthAndYongsin(dayGanIndex, monthZhiIndex, elementCounts) {
            const dayMasterElement = ELEMENTS.gan[dayGanIndex];
            const elMap = ['æœ¨', 'ç«', 'åœŸ', 'é‡‘', 'æ°´'];
            const myElIdx = elMap.indexOf(dayMasterElement);
            
            const motherElIdx = (myElIdx - 1 + 5) % 5;
            const motherElement = elMap[motherElIdx];

            const myForceScore = (elementCounts[dayMasterElement] || 0) + (elementCounts[motherElement] || 0);
            const totalForce = 8;

            const monthEl = ELEMENTS.zhi[monthZhiIndex];
            const isDeungRyeong = (monthEl === dayMasterElement || monthEl === motherElement);

            let isSinGang = false;
            if (isDeungRyeong) {
                if (myForceScore >= 3) isSinGang = true;
            } else {
                if (myForceScore >= 5) isSinGang = true;
            }

            let yongsinList = [];
            let gisinList = [];

            if (isSinGang) {
                yongsinList.push(elMap[(myElIdx + 1) % 5]);
                yongsinList.push(elMap[(myElIdx + 2) % 5]);
                yongsinList.push(elMap[(myElIdx + 3) % 5]);
        
                gisinList.push(dayMasterElement);
                gisinList.push(motherElement);
            } else {
                yongsinList.push(motherElement);
                yongsinList.push(dayMasterElement);
        
                gisinList.push(elMap[(myElIdx + 1) % 5]);
                gisinList.push(elMap[(myElIdx + 2) % 5]);
                gisinList.push(elMap[(myElIdx + 3) % 5]);
            }

            return {
                isSinGang: isSinGang,
                yongsin: yongsinList,
                gisin: gisinList,
                myElement: dayMasterElement
            };
        }

        // ============================================================
        // UI INITIALIZATION
        // ============================================================

        // Chart.js ë¡œë”©ì„ í™•ì‹¤íˆ ê¸°ë‹¤ë¦¬ëŠ” í•¨ìˆ˜
        function waitForChart(callback) {
            if (typeof Chart !== 'undefined') {
                callback();
            } else {
                console.log('Waiting for Chart.js...');
                setTimeout(function() {
                    waitForChart(callback);
                }, 100);
            }
        }

        // í˜ì´ì§€ ë¡œë”© ì™„ë£Œ í›„ ì´ˆê¸°í™”
        // ============================================================
        // PILLAR EDITING (ê¸°ë‘¥ ìˆ˜ì •)
        // ============================================================

        // í˜„ì¬ ë¶„ì„ëœ ì‚¬ì£¼ ë°ì´í„°ë¥¼ ì €ì¥ (ìˆ˜ì •ìš©)
        let currentAnalysisData = {
            yearPillar: null,
            monthPillar: null,
            dayPillar: null,
            timePillar: null,
            birthDate: null,
            referenceDate: null
        };

        let editingPillarKey = null; // 'yearPillar', 'monthPillar', 'dayPillar', 'timePillar'
        let editSelectedGan = -1;
        let editSelectedZhi = -1;

        const ELEMENT_CLASS_MAP = {
            'ëª©(æœ¨)': 'wood', 'í™”(ç«)': 'fire', 'í† (åœŸ)': 'earth', 'ê¸ˆ(é‡‘)': 'metal', 'ìˆ˜(æ°´)': 'water'
        };

        function openPillarEditModal(pillarKey) {
            editingPillarKey = pillarKey;
            const pillarData = currentAnalysisData[pillarKey];
            if (!pillarData) return;

            editSelectedGan = pillarData.gan;
            editSelectedZhi = pillarData.zhi;

            const nameMap = {
                'yearPillar': t('pillarYear'),
                'monthPillar': t('pillarMonth'),
                'dayPillar': t('pillarDay'),
                'timePillar': t('pillarTime')
            };
            document.getElementById('pillarModalTitle').textContent = `${nameMap[pillarKey]} ${t('modalEdit')}`;

            renderGanSelector();
            renderZhiSelector();
            switchPillarTab('gan');

            document.getElementById('pillarEditModal').classList.add('active');
        }

        function closePillarEditModal() {
            document.getElementById('pillarEditModal').classList.remove('active');
            editingPillarKey = null;
        }

        function switchPillarTab(type) {
            const ganTab = document.getElementById('ganTab');
            const zhiTab = document.getElementById('zhiTab');
            const ganPanel = document.getElementById('ganSelectorPanel');
            const zhiPanel = document.getElementById('zhiSelectorPanel');

            if (type === 'gan') {
                ganTab.classList.add('active');
                zhiTab.classList.remove('active');
                ganPanel.style.display = 'block';
                zhiPanel.style.display = 'none';
            } else {
                ganTab.classList.remove('active');
                zhiTab.classList.add('active');
                ganPanel.style.display = 'none';
                zhiPanel.style.display = 'block';
            }
        }

        function renderGanSelector() {
            const grid = document.getElementById('ganSelectorGrid');
            grid.innerHTML = '';

            TIAN_GAN_KR.forEach((g, idx) => {
                const item = document.createElement('div');
                const elClass = ELEMENT_CLASS_MAP[g.element] || '';
                item.className = `pillar-selector-item ${elClass} ${idx === editSelectedGan ? 'selected' : ''}`;
                item.innerHTML = `
                    <div class="pillar-selector-char">${g.hanja}</div>
                    <div class="pillar-selector-info">${g.name}${g.element.charAt(0)}</div>
                `;
                item.onclick = () => {
                    editSelectedGan = idx;
                    renderGanSelector();
                };
                grid.appendChild(item);
            });
        }

        function renderZhiSelector() {
            const grid = document.getElementById('zhiSelectorGrid');
            grid.innerHTML = '';

            DI_ZHI_KR.forEach((z, idx) => {
                const item = document.createElement('div');
                const elClass = ELEMENT_CLASS_MAP[z.element] || '';
                item.className = `pillar-selector-item ${elClass} ${idx === editSelectedZhi ? 'selected' : ''}`;
                item.innerHTML = `
                    <div class="pillar-selector-char">${z.hanja}</div>
                    <div class="pillar-selector-info">${z.name}(${z.animal.split('(')[0]})</div>
                `;
                item.onclick = () => {
                    editSelectedZhi = idx;
                    renderZhiSelector();
                };
                grid.appendChild(item);
            });
        }

        function applyPillarEdit() {
            if (!editingPillarKey) return;

            // ìˆ˜ì •ëœ ê°’ ì ìš©
            currentAnalysisData[editingPillarKey] = {
                gan: editSelectedGan,
                zhi: editSelectedZhi
            };

            // ì „ì²´ ë¶„ì„ ë‹¤ì‹œ ìˆ˜í–‰ (ìˆ˜ì •ëœ ê¸°ë‘¥ ë°ì´í„° ê¸°ë°˜)
            reanalyzeWithModifiedPillars();

            closePillarEditModal();
            showToast(t('toastEdited'));
        }

        function reanalyzeWithModifiedPillars() {
            const yearPillar = currentAnalysisData.yearPillar;
            const monthPillar = currentAnalysisData.monthPillar;
            const dayPillar = currentAnalysisData.dayPillar;
            const timePillar = currentAnalysisData.timePillar;
            const birthDate = currentAnalysisData.birthDate;
            const referenceDate = currentAnalysisData.referenceDate;

            const pillars = [yearPillar, monthPillar, dayPillar, timePillar];
            const tojeong = calculateTojeongBigyeol(birthDate, referenceDate);

            updatePillarsDisplay(yearPillar, monthPillar, dayPillar, timePillar);
            updateSipganSipyiji(pillars);
            updateSajuElements(dayPillar, yearPillar, birthDate, referenceDate);
            updateElementAnalysis(pillars);
            updatePersonalityAnalysis(dayPillar.gan);
            updateDecadeFlowChart(dayPillar.gan, birthDate, referenceDate, yearPillar, monthPillar, pillars);
            updateTojeongBigyeol(tojeong);
            updateFortuneBreakdown(pillars, birthDate, referenceDate);
            updateOverallAnalysis(dayPillar.gan, tojeong);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

        // ===== ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™” =====
        function initBirthDropdowns() {
            const now = new Date();
            const currentYear = now.getFullYear();

            // ë…„ë„ ë“œë¡­ë‹¤ìš´ (1920~í˜„ì¬+1)
            const yearSel = document.getElementById('birthYearSelect');
            yearSel.innerHTML = '<option value="">ì—°ë„</option>';
            for (let y = currentYear + 1; y >= 1920; y--) {
                const opt = document.createElement('option');
                opt.value = y;
                opt.textContent = y + 'ë…„';
                yearSel.appendChild(opt);
            }

            // ì›” ë“œë¡­ë‹¤ìš´
            const monthSel = document.getElementById('birthMonthSelect');
            monthSel.innerHTML = '<option value="">ì›”</option>';
            for (let m = 1; m <= 12; m++) {
                const opt = document.createElement('option');
                opt.value = String(m).padStart(2, '0');
                opt.textContent = m + 'ì›”';
                monthSel.appendChild(opt);
            }

            // ì¼ ë“œë¡­ë‹¤ìš´
            const daySel = document.getElementById('birthDaySelect');
            daySel.innerHTML = '<option value="">ì¼</option>';
            for (let d = 1; d <= 31; d++) {
                const opt = document.createElement('option');
                opt.value = String(d).padStart(2, '0');
                opt.textContent = d + 'ì¼';
                daySel.appendChild(opt);
            }

            // ë¶„ì„ ê¸°ì¤€ ë…„ë„ ë“œë¡­ë‹¤ìš´ (ê°„ì§€+ë  í‘œì‹œ)
            const yearInput = document.getElementById('yearInput');
            yearInput.innerHTML = '';
            for (let y = 2024; y <= 2036; y++) {
                const opt = document.createElement('option');
                opt.value = y;
                opt.textContent = getGanjiLabel(y);
                if (y === currentYear) opt.selected = true;
                yearInput.appendChild(opt);
            }

            // ì›”/ë…„ ë³€ê²½ì‹œ ì¼ìˆ˜ ì—…ë°ì´íŠ¸
            yearSel.addEventListener('change', updateBirthDays);
            monthSel.addEventListener('change', updateBirthDays);

            // ë“œë¡­ë‹¤ìš´ ë³€ê²½ì‹œ hidden input ë™ê¸°í™”
            yearSel.addEventListener('change', syncBirthDateInput);
            monthSel.addEventListener('change', syncBirthDateInput);
            daySel.addEventListener('change', syncBirthDateInput);
        }

        function updateBirthDays() {
            const yearVal = parseInt(document.getElementById('birthYearSelect').value);
            const monthVal = parseInt(document.getElementById('birthMonthSelect').value);
            const daySel = document.getElementById('birthDaySelect');
            const currentDay = daySel.value;
            const dayUnit = currentLang === 'ko' ? 'ì¼' : '';

            let maxDays = 31;
            if (yearVal && monthVal) {
                maxDays = new Date(yearVal, monthVal, 0).getDate();
            }

            daySel.innerHTML = `<option value="">${t('optDay')}</option>`;
            for (let d = 1; d <= maxDays; d++) {
                const opt = document.createElement('option');
                opt.value = String(d).padStart(2, '0');
                opt.textContent = d + dayUnit;
                if (String(d).padStart(2, '0') === currentDay && d <= maxDays) {
                    opt.selected = true;
                }
                daySel.appendChild(opt);
            }
            syncBirthDateInput();
        }

        function syncBirthDateInput() {
            const y = document.getElementById('birthYearSelect').value;
            const m = document.getElementById('birthMonthSelect').value;
            const d = document.getElementById('birthDaySelect').value;
            if (y && m && d) {
                document.getElementById('birthDateInput').value = `${y}-${m}-${d}`;
            } else {
                document.getElementById('birthDateInput').value = '';
            }
        }

        function initializeApp() {
            waitForChart(function() {
                console.log('Chart.js loaded successfully!');

                // ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
                initBirthDropdowns();

                // i18n ì´ˆê¸° ì ìš©
                applyI18nToDOM();

            document.getElementById('analyzeBtn').addEventListener('click', analyzesFortune);
            document.getElementById('copyBtn').addEventListener('click', copyResults);
            document.getElementById('printBtn').addEventListener('click', printResults);
            document.getElementById('screenshotBtn').addEventListener('click', takeScreenshot);
            document.getElementById('scrollTopBtn').addEventListener('click', scrollToTop);
            document.getElementById('printFloatingBtn').addEventListener('click', printResults);

            window.addEventListener('scroll', updateScrollButtons);

            // ë¡œë”© í™”ë©´ ìˆ¨ê¹€
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
            }, 300);
            });
        }

        function analyzesFortune() {
            const birthDateStr = document.getElementById('birthDateInput').value;
            const name = document.getElementById('nameInput').value || (currentLang === 'ko' ? 'ì‚¬ìš©ì' : 'User');
            const timeIndex = document.getElementById('birthTimeInput').value;
            const referenceYear = parseInt(document.getElementById('yearInput').value);

            if (!birthDateStr) {
                alert(t('alertInput'));
                return;
            }

            const birthDate = new Date(birthDateStr + 'T00:00:00');

            const referenceDate = new Date(referenceYear, 0, 1);

            const yearPillar = calculateYearPillar(birthDate);
            const monthPillar = calculateMonthPillar(birthDate);
            const dayPillar = calculateDayPillar(birthDate);
            const timePillar = calculateTimePillar(birthDate, timeIndex);

            // ìˆ˜ì • ê¸°ëŠ¥ì„ ìœ„í•´ í˜„ì¬ ë¶„ì„ ë°ì´í„° ì €ì¥
            currentAnalysisData.yearPillar = { gan: yearPillar.gan, zhi: yearPillar.zhi };
            currentAnalysisData.monthPillar = { gan: monthPillar.gan, zhi: monthPillar.zhi };
            currentAnalysisData.dayPillar = { gan: dayPillar.gan, zhi: dayPillar.zhi };
            currentAnalysisData.timePillar = { gan: timePillar.gan, zhi: timePillar.zhi };
            currentAnalysisData.birthDate = birthDate;
            currentAnalysisData.referenceDate = referenceDate;

            const pillars = [yearPillar, monthPillar, dayPillar, timePillar];

            const tojeong = calculateTojeongBigyeol(birthDate, referenceDate);

            updatePillarsDisplay(yearPillar, monthPillar, dayPillar, timePillar);
            updateSipganSipyiji(pillars);
            updateSajuElements(dayPillar, yearPillar, birthDate, referenceDate);
            updateElementAnalysis(pillars);
            updatePersonalityAnalysis(dayPillar.gan);
            updateDecadeFlowChart(dayPillar.gan, birthDate, referenceDate, yearPillar, monthPillar, pillars);
            updateTojeongBigyeol(tojeong);
            updateFortuneBreakdown(pillars, birthDate, referenceDate);
            updateOverallAnalysis(dayPillar.gan, tojeong);

            document.getElementById('resultsContainer').classList.remove('hidden');

            setTimeout(() => {
                document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        function updatePillarsDisplay(yearPillar, monthPillar, dayPillar, timePillar) {
            const isEn = currentLang === 'en';
            const pillarNames = {
                'yearPillar': { name: t('pillarYear'), desc: isEn ? 'Energy of birth year' : 'íƒœì–´ë‚œ í•´ì˜ ê¸°ìš´' },
                'monthPillar': { name: t('pillarMonth'), desc: isEn ? 'Energy of birth month' : 'íƒœì–´ë‚œ ë‹¬ì˜ ê¸°ìš´' },
                'dayPillar': { name: t('pillarDay'), desc: isEn ? 'Energy of birth day (Self)' : 'íƒœì–´ë‚œ ë‚ ì˜ ê¸°ìš´ (ë³¸ì¸)' },
                'timePillar': { name: t('pillarTime'), desc: isEn ? 'Energy of birth hour' : 'íƒœì–´ë‚œ ì‹œê°„ì˜ ê¸°ìš´' }
            };
            const tooltipLabels = {
                desc: isEn ? 'Desc' : 'ì„¤ëª…',
                stem: isEn ? 'Stem' : 'ì²œê°„',
                branch: isEn ? 'Branch' : 'ì§€ì§€',
                hangul: isEn ? 'Name' : 'í•œê¸€',
                ohaeng: isEn ? 'Element' : 'ì˜¤í–‰',
                yinyang: isEn ? 'Yin/Yang' : 'ìŒì–‘',
                zodiac: isEn ? 'Zodiac' : 'ë ',
                noTime: isEn ? 'Select birth time<br>for detailed info' : 'ì¶œìƒ ì‹œê°„ì„ ì„ íƒí•˜ë©´<br>ìƒì„¸ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤'
            };
            const editBtnText = t('modalEdit');
            const pillars = [
                { id: 'yearPillar', pillar: yearPillar },
                { id: 'monthPillar', pillar: monthPillar },
                { id: 'dayPillar', pillar: dayPillar },
                { id: 'timePillar', pillar: timePillar }
            ];

            pillars.forEach(item => {
                const element = document.getElementById(item.id);
                const info = pillarNames[item.id];

                // ì˜¤í–‰ì— ë”°ë¥¸ í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸
                ['wood', 'fire', 'earth', 'metal', 'water'].forEach(cls => element.classList.remove(cls));
                if (item.pillar.gan >= 0) {
                    const ganElement = TIAN_GAN_KR[item.pillar.gan].element;
                    const elClass = ELEMENT_CLASS_MAP[ganElement];
                    if (elClass) element.classList.add(elClass);
                }

                if (item.pillar.gan >= 0 && item.pillar.zhi >= 0) {
                    const gan = TIAN_GAN[item.pillar.gan];
                    const zhi = DI_ZHI[item.pillar.zhi];
                    const ganInfo = TIAN_GAN_KR[item.pillar.gan];
                    const zhiInfo = DI_ZHI_KR[item.pillar.zhi];

                    element.innerHTML = `
                        <button class="pillar-edit-btn" onclick="event.stopPropagation(); openPillarEditModal('${item.id}')">${editBtnText}</button>
                        <div class="text-xs text-gray-300 mb-1">${info.name}</div>
                        <div>${gan}${zhi}</div>
                        <div class="pillar-tooltip">
                            <div class="tooltip-title">${info.name} (${gan}${zhi})</div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.desc}</span><span class="tooltip-value" style="font-size:11px">${info.desc}</span></div>
                            <div style="margin:6px 0 3px;color:#d4a574;font-size:12px;font-weight:600;">${tooltipLabels.stem} - ${gan}</div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.hangul}</span><span class="tooltip-value">${ganInfo.name}</span></div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.ohaeng}</span><span class="tooltip-value">${ganInfo.element}</span></div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.yinyang}</span><span class="tooltip-value">${ganInfo.yinyang}</span></div>
                            <div style="margin:6px 0 3px;color:#d4a574;font-size:12px;font-weight:600;">${tooltipLabels.branch} - ${zhi}</div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.hangul}</span><span class="tooltip-value">${zhiInfo.name}</span></div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.zodiac}</span><span class="tooltip-value">${zhiInfo.animal}</span></div>
                            <div class="tooltip-row"><span class="tooltip-label">${tooltipLabels.ohaeng}</span><span class="tooltip-value">${zhiInfo.element}</span></div>
                        </div>
                    `;
                } else {
                    element.innerHTML = `
                        <button class="pillar-edit-btn" onclick="event.stopPropagation(); openPillarEditModal('${item.id}')">${editBtnText}</button>
                        <div class="text-xs text-gray-300 mb-1">${info.name}</div>
                        <div>?</div>
                        <div class="pillar-tooltip">
                            <div class="tooltip-title">${info.name}</div>
                            <div style="text-align:center;color:#a0a0a0;font-size:13px;padding:8px 0;">${tooltipLabels.noTime}</div>
                        </div>
                    `;
                }
            });
        }

        function updateSipganSipyiji(pillars) {
            const myGans = pillars.filter(p => p.gan >= 0).map(p => p.gan);
            let ganHtml = '';
            TIAN_GAN_KR.forEach((g, idx) => {
                const isActive = myGans.includes(idx);
                const bgColor = isActive ? `background:${g.color}33;border:1px solid ${g.color};` : 'background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);';
                const textColor = isActive ? `color:${g.color};font-weight:700;` : 'color:#888;';
                ganHtml += `<span style="display:inline-block;padding:4px 8px;border-radius:6px;font-size:13px;${bgColor}${textColor}" title="${g.name}(${g.hanja})">${g.hanja}${g.name}</span>`;
            });
            document.getElementById('tenGanInfo').innerHTML = ganHtml;

            const myZhis = pillars.filter(p => p.zhi >= 0).map(p => p.zhi);
            let zhiHtml = '';
            DI_ZHI_KR.forEach((z, idx) => {
                const isActive = myZhis.includes(idx);
                const elColor = ELEMENT_COLORS[ELEMENTS.zhi[idx]];
                const bgColor = isActive ? `background:${elColor}33;border:1px solid ${elColor};` : 'background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);';
                const textColor = isActive ? `color:${elColor};font-weight:700;` : 'color:#888;';
                zhiHtml += `<span style="display:inline-block;padding:4px 8px;border-radius:6px;font-size:13px;${bgColor}${textColor}" title="${z.name}(${z.hanja})">${z.hanja}${z.name}</span>`;
            });
            document.getElementById('twelveZhiInfo').innerHTML = zhiHtml;
        }

        function updateSajuElements(dayPillar, yearPillar, birthDate, referenceDate) {
            const ganInfo = TIAN_GAN_KR[dayPillar.gan];
            const pd = I18N[currentLang].personalityDesc[dayPillar.gan];
            document.getElementById('dayMasterInfo').innerHTML = `${ganInfo.hanja} ${ganInfo.name} - ${ganInfo.element}`;
            document.getElementById('dayMasterDesc').textContent = currentLang === 'ko' ? ganInfo.meaning : pd.desc.split('.')[0] + '.';

            const manAge = calculateKoreanAge(birthDate, referenceDate);
            const tradAge = calculateTraditionalKoreanAge(birthDate, referenceDate);
            document.getElementById('koreanAgeInfo').textContent = t('manAge').replace('{age}', manAge);
            document.getElementById('koreanAgeDetail').textContent = t('tradAge').replace('{age}', tradAge);

            const yearZhiInfo = DI_ZHI_KR[yearPillar.zhi];
            if (currentLang === 'ko') {
                document.getElementById('zodiacInfo').innerHTML = `${yearZhiInfo.animal}`;
            } else {
                const enAnimals = ['Rat(é¼ )','Ox(ç‰›)','Tiger(è™)','Rabbit(å…”)','Dragon(é¾)','Snake(è›‡)','Horse(é¦¬)','Goat(ç¾Š)','Monkey(çŒ´)','Rooster(é·„)','Dog(çŠ¬)','Pig(è±¬)'];
                document.getElementById('zodiacInfo').innerHTML = enAnimals[yearPillar.zhi];
            }
        }

        function updateElementAnalysis(pillars) {
            const counts = countElements(pillars);

            const unit = t('unitCount');
            document.getElementById('elementWood').textContent = counts['æœ¨'] + unit;
            document.getElementById('elementFire').textContent = counts['ç«'] + unit;
            document.getElementById('elementEarth').textContent = counts['åœŸ'] + unit;
            document.getElementById('elementMetal').textContent = counts['é‡‘'] + unit;
            document.getElementById('elementWater').textContent = counts['æ°´'] + unit;

            updateElementChart(counts);
            updateElementAdvice(counts);
        }

        function updateElementAdvice(counts) {
            const container = document.getElementById('elementAdviceCards');
            const total = Object.values(counts).reduce((a, b) => a + b, 0);
            const avg = total / 5;
            const i18nAdvice = I18N[currentLang].elementAdvice;

            let html = '';
            const elements = ['æœ¨', 'ç«', 'åœŸ', 'é‡‘', 'æ°´'];

            elements.forEach(el => {
                const advice = ELEMENT_ADVICE[el];
                const count = counts[el];
                let status = null;

                if (count >= avg + 1.2 || count >= 3) {
                    status = 'excess';
                } else if (count === 0) {
                    status = 'deficiency';
                }

                if (status) {
                    const statusIcon = status === 'excess' ? 'ğŸ“ˆ' : 'ğŸ“‰';
                    const statusLabel = status === 'excess' ? t('adviceExcess') : t('adviceDeficiency');
                    const i18nInfo = i18nAdvice[el] && i18nAdvice[el][status] ? i18nAdvice[el][status] : advice[status];

                    html += `
                        <div style="background:${advice.bgColor}; border-left:4px solid ${advice.borderColor}; border-radius:8px; padding:16px 20px;">
                            <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                                <span style="font-size:18px;">${advice.icon}</span>
                                <span style="color:${advice.color}; font-weight:700; font-size:15px;">${advice.name} ${statusLabel}</span>
                                <span style="font-size:13px;">${statusIcon}</span>
                            </div>
                            <p style="color:#ccc; font-size:13px; margin-bottom:8px;">${i18nInfo.symptom}</p>
                            <div style="display:flex; align-items:flex-start; gap:6px;">
                                <span style="color:#4caf50; font-size:14px;">âœ…</span>
                                <span style="color:#e0e0e0; font-size:13px;">${i18nInfo.advice}</span>
                            </div>
                        </div>
                    `;
                }
            });

            if (!html) {
                html = `
                    <div style="background:rgba(76,175,80,0.08); border-left:4px solid rgba(76,175,80,0.4); border-radius:8px; padding:16px 20px;">
                        <span style="color:#81c784; font-weight:700;">${t('ohaengBalance')}</span>
                        <p style="color:#ccc; font-size:13px; margin-top:8px;">${t('ohaengBalanceDesc')}</p>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function updateElementChart(counts) {
            const ctx = document.getElementById('elementChart').getContext('2d');

            if (window.elementChartInstance) {
                window.elementChartInstance.destroy();
            }

            window.elementChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: [t('elWood')+'(æœ¨)', t('elFire')+'(ç«)', t('elEarth')+'(åœŸ)', t('elMetal')+'(é‡‘)', t('elWater')+'(æ°´)'],
                    datasets: [{
                        data: [counts['æœ¨'], counts['ç«'], counts['åœŸ'], counts['é‡‘'], counts['æ°´']],
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(244, 67, 54, 0.7)',
                            'rgba(255, 193, 7, 0.7)',
                            'rgba(189, 189, 189, 0.7)',
                            'rgba(33, 150, 243, 0.7)'
                        ],
                        borderColor: [
                            '#4CAF50',
                            '#F44336',
                            '#FFC107',
                            '#BDBDBD',
                            '#2196F3'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#d4a574',
                                font: { family: "'Noto Sans KR', sans-serif" }
                            }
                        }
                    }
                }
            });
        }

        function updatePersonalityAnalysis(dayGan) {
            const pd = I18N[currentLang].personalityDesc[dayGan];
            document.getElementById('personalityTitle').textContent = pd.name;
            document.getElementById('personalityDescription').textContent = pd.desc;
            document.getElementById('strengths').textContent = pd.str;
            document.getElementById('weaknesses').textContent = pd.wk;
            document.getElementById('aptitude').textContent = pd.apt;
        }

        // âœ… FIXED: íŒŒë¼ë¯¸í„° ìˆœì„œ ìˆ˜ì •
        function updateDecadeFlowChart(dayGan, birthDate, referenceDate, yearPillar, monthPillar, pillars) {
            const genderInput = document.querySelector('input[name="gender"]:checked');
            const gender = genderInput ? genderInput.value : 'male';
            
            const timeIndex = document.getElementById('birthTimeInput').value;
            const timePillar = calculateTimePillar(birthDate, timeIndex);
            const allPillars = pillars || [yearPillar, monthPillar, {gan: dayGan, zhi: calculateDayPillar(birthDate).zhi}, timePillar];
            const elementCounts = countElements(allPillars);

            const daewuns = calculateDaewunList(gender, yearPillar.gan, monthPillar.gan, monthPillar.zhi);
            const sajuAnalysis = calculateSajuStrengthAndYongsin(dayGan, monthPillar.zhi, elementCounts);

            const currentAge = calculateKoreanAge(birthDate, referenceDate);
            const decadeLabels = [];
            const decadeScores = [];
            const decadeColors = [];
            const decadeDetails = [];

            daewuns.forEach((dw, idx) => {
                const startAge = (idx + 1) * 10;
                const endAge = startAge + 9;
        
                const ganEl = ELEMENTS.gan[dw.gan];
                const zhiEl = ELEMENTS.zhi[dw.zhi];
                
                let score = 50;
                
                if (sajuAnalysis.yongsin.includes(ganEl)) score += 15;
                else if (sajuAnalysis.gisin.includes(ganEl)) score -= 10;
                
                if (sajuAnalysis.yongsin.includes(zhiEl)) score += 35;
                else if (sajuAnalysis.gisin.includes(zhiEl)) score -= 20;
        
                score = Math.min(98, Math.max(20, score));
        
                const color = ELEMENT_COLORS[zhiEl];
                const isCurrent = currentAge >= startAge && currentAge <= endAge;
        
                decadeLabels.push(currentLang === 'ko' ? `${startAge}ëŒ€ìš´` : `${startAge}s`);
                decadeScores.push(score);
                decadeColors.push(isCurrent ? '#d4a574' : color);
        
                decadeDetails.push({
                    range: currentLang === 'ko' ? `${startAge}~${endAge}ì„¸` : `Age ${startAge}~${endAge}`,
                    gan: TIAN_GAN[dw.gan],
                    zhi: DI_ZHI[dw.zhi],
                    ganKr: TIAN_GAN_KR[dw.gan],
                    zhiKr: DI_ZHI_KR[dw.zhi],
                    element: zhiEl,
                    score: score,
                    isCurrent: isCurrent,
                    desc: getScoreDescription(score)
                });
            });

            const ctx = document.getElementById('decadeFlowChart').getContext('2d');
            if (window.decadeFlowChartInstance) {
                window.decadeFlowChartInstance.destroy();
            }
        
            window.decadeFlowChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: decadeLabels,
                    datasets: [{
                        label: t('fortuneFlow'),
                        data: decadeScores,
                        borderColor: '#d4a574',
                        backgroundColor: 'rgba(212, 165, 116, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: decadeColors,
                        pointRadius: 6,
                        pointHoverRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            min: 0, 
                            max: 100,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#a0a0a0' }
                        },
                        x: { 
                            grid: { display: false },
                            ticks: { color: '#a0a0a0' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#d4a574' }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const d = decadeDetails[context.dataIndex];
                                    const pUnit = t('pointUnit');
                                    return currentLang === 'ko' ? `${d.gan}${d.zhi}ëŒ€ìš´: ${d.score}ì  - ${d.desc}` : `${d.gan}${d.zhi}: ${d.score}${pUnit} - ${d.desc}`;
                                }
                            }
                        }
                    }
                }
            });

            const detailsContainer = document.getElementById('decadeFlowDetails');
            let detailsHtml = '';
            
            decadeDetails.forEach(d => {
                const elColor = ELEMENT_COLORS[d.element];
                const borderStyle = d.isCurrent ? 'border: 2px solid #d4a574;' : 'border: 1px solid rgba(255,255,255,0.1);';
                
                detailsHtml += `
                    <div style="${borderStyle} border-radius:8px; padding:12px;">
                        <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                            <span style="color:#d4a574; font-weight:bold;">${d.range}</span>
                            <span style="color:${elColor}; font-weight:bold;">${d.gan}${d.zhi}</span>
                        </div>
                        <div style="margin-top:6px; background:rgba(0,0,0,0.3); height:4px; border-radius:2px;">
                            <div style="width:${d.score}%; height:100%; background:${elColor};"></div>
                        </div>
                        <div style="text-align:right; font-size:11px; color:#ccc; margin-top:2px;">${d.desc} (${d.score}${t('pointUnit')})</div>
                    </div>
                `;
            });
            detailsContainer.innerHTML = detailsHtml;
        }

        function updateTojeongBigyeol(tojeong) {
            document.getElementById('upperHexagram').innerHTML = generateHexagram(tojeong.upper);
            document.getElementById('middleHexagram').innerHTML = generateHexagram(tojeong.middle);
            document.getElementById('lowerHexagram').innerHTML = generateHexagram(tojeong.lower);

            const verses = I18N[currentLang].fortuneVerses;
            const idx = (tojeong.upper + tojeong.middle + tojeong.lower) % verses.length;
            const verse = verses[idx];
            document.getElementById('yearFortune').textContent = verse.meaning;
        }

        function generateHexagram(guaNumber) {
            let html = '';
            for (let i = 0; i < 3; i++) {
                const isSolid = hexagramToYinYang(i, guaNumber);
                html += `<div class="hexagram-line ${isSolid ? 'solid' : 'broken'}">`;
                html += isSolid ? 'â”â”' : 'â” â”';
                html += '</div>';
            }
            return html;
        }

        function updateFortuneBreakdown(pillars, birthDate, referenceDate) {
            const monthlyFortunesContainer = document.getElementById('monthlyFortunes');
            monthlyFortunesContainer.innerHTML = '';

            const verses = I18N[currentLang].fortuneVerses;
            const baseIndex = birthDate.getDate() + birthDate.getMonth();

            for (let month = 1; month <= 12; month++) {
                const verseIndex = (baseIndex + month) % verses.length;
                const verse = verses[verseIndex];
                const monthLabel = t('monthLabel').replace('{m}', month);

                const monthHtml = `
                    <div class="month-fortune">
                        <span class="month-number">${monthLabel}</span>
                        <span class="month-fortune-text">${verse.meaning}</span>
                    </div>
                `;
                monthlyFortunesContainer.innerHTML += monthHtml;
            }

            updateFortuneChart(pillars, birthDate, referenceDate);
        }

        function updateFortuneChart(pillars, birthDate, referenceDate) {
            const yearGan = pillars[0].gan;
            const monthZhi = pillars[1].zhi;
            const dayGan = pillars[2].gan;
            const dayZhi = pillars[2].zhi;

            const age = calculateKoreanAge(birthDate, referenceDate);

            const wealthScore = (yearGan * 7 + dayGan * 3 + 50) % 40 + 60;
            const loveScore = (monthZhi * 6 + dayZhi * 4 + 45) % 40 + 50;
            const healthScore = (dayGan * 8 + age * 2 + 60) % 30 + 70;
            const careerScore = (yearGan * 5 + monthZhi * 3 + age + 55) % 35 + 65;
            const studyScore = (dayZhi * 4 + yearGan * 2 + 50) % 40 + 55;

            const pu = t('pointUnit');
            document.getElementById('wealthScore').textContent = Math.round(wealthScore) + pu;
            document.getElementById('loveScore').textContent = Math.round(loveScore) + pu;
            document.getElementById('healthScore').textContent = Math.round(healthScore) + pu;
            document.getElementById('careerScore').textContent = Math.round(careerScore) + pu;
            document.getElementById('studyScore').textContent = Math.round(studyScore) + pu;

            document.getElementById('wealthText').textContent = getFortuneText(wealthScore, 'wealth');
            document.getElementById('loveText').textContent = getFortuneText(loveScore, 'love');
            document.getElementById('healthText').textContent = getFortuneText(healthScore, 'health');
            document.getElementById('careerText').textContent = getFortuneText(careerScore, 'career');
            document.getElementById('studyText').textContent = getFortuneText(studyScore, 'study');

            const ctx = document.getElementById('fortuneChart').getContext('2d');
            if (window.fortuneChartInstance) {
                window.fortuneChartInstance.destroy();
            }

            window.fortuneChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: [t('catWealth'), t('catLove'), t('catHealth'), t('catCareer'), t('catStudy')],
                    datasets: [{
                        label: t('fortuneScore'),
                        data: [
                            Math.round(wealthScore),
                            Math.round(loveScore),
                            Math.round(healthScore),
                            Math.round(careerScore),
                            Math.round(studyScore)
                        ],
                        borderColor: '#d4a574',
                        backgroundColor: 'rgba(212, 165, 116, 0.2)',
                        borderWidth: 2,
                        fill: true,
                        pointBackgroundColor: '#d4a574',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            grid: { color: 'rgba(212, 165, 116, 0.1)' },
                            ticks: { color: '#a0a0a0' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#d4a574' }
                        }
                    }
                }
            });
        }

        function getFortuneText(score, category) {
            const texts = I18N[currentLang].fortuneTexts;

            let index = 0;
            if (score >= 85) index = 3;
            else if (score >= 70) index = 2;
            else if (score >= 55) index = 1;

            return texts[category][index];
        }

        function updateOverallAnalysis(dayGan, tojeong) {
            const personality = PERSONALITIES[dayGan];
            const pd = I18N[currentLang].personalityDesc[dayGan];
            const refYear = parseInt(document.getElementById('yearInput').value);
            const yearLabel = currentLang === 'ko' ? getGanjiLabel(refYear) : getGanjiLabelEn(refYear);

            document.getElementById('overallYearLabel').textContent = `${yearLabel} ${t('yearFortuneLabel')}`;

            const overallScore = (dayGan * 8 + tojeong.upper * 5 + tojeong.middle * 3 + 50) % 30 + 70;

            document.getElementById('overallScore').style.setProperty('--score-deg', (overallScore * 3.6) + 'deg');
            document.getElementById('overallScore').querySelector('span').textContent = Math.round(overallScore);

            document.getElementById('overallAnalysis').textContent =
                t('overallAnalysisTpl').replace('{strengths}', pd.str);

            document.getElementById('overallAdvice').textContent = t('overallAdviceTpl');

            document.getElementById('overallWarning').textContent =
                t('overallWarningTpl').replace('{weaknesses}', pd.wk);
        }

        function updateScrollButtons() {
            const scrollTopBtn = document.getElementById('scrollTopBtn');
            const printBtn = document.getElementById('printFloatingBtn');

            if (window.scrollY > 500) {
                scrollTopBtn.classList.remove('hidden');
                printBtn.classList.remove('hidden');
            } else {
                scrollTopBtn.classList.add('hidden');
                printBtn.classList.add('hidden');
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function copyResults() {
            const resultsText = generateResultsText();
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(resultsText).then(() => {
                    showToast(t('toastCopyOk'));
                }).catch(err => {
                    fallbackCopy(resultsText);
                });
            } else {
                fallbackCopy(resultsText);
            }
        }

        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.left = '-9999px';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showToast(t('toastCopyOk'));
            } catch (err) {
                showToast(t('toastCopyFail'), true);
            }
            document.body.removeChild(textarea);
        }

        function showToast(message, isError) {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
                background: ${isError ? 'rgba(244,67,54,0.9)' : 'rgba(76,175,80,0.9)'};
                color: white; padding: 14px 28px; border-radius: 8px;
                font-size: 14px; z-index: 10000;
                box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            `;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 2500);
        }

        function generateResultsText() {
            const name = document.getElementById('nameInput').value || (currentLang === 'ko' ? 'ì‚¬ìš©ì' : 'User');
            const birthDate = document.getElementById('birthDateInput').value;
            const year = document.getElementById('yearInput').value;
            const yearLabel = currentLang === 'ko' ? getGanjiLabel(parseInt(year)) : getGanjiLabelEn(parseInt(year));

            if (currentLang === 'ko') {
                let text = `========== í† ì •ë¹„ê²° & ì‚¬ì£¼íŒ”ì ë¶„ì„ ê²°ê³¼ ==========\n\n`;
                text += `ì´ë¦„: ${name}\n`;
                text += `ìƒë…„ì›”ì¼: ${birthDate}\n`;
                text += `ë¶„ì„ ê¸°ì¤€: ${yearLabel}\n\n`;
                text += `==========================================\n`;
                return text;
            } else {
                let text = `========== Tojeong & Saju Analysis Results ==========\n\n`;
                text += `Name: ${name}\n`;
                text += `Date of Birth: ${birthDate}\n`;
                text += `Analysis Year: ${yearLabel}\n\n`;
                text += `==========================================\n`;
                return text;
            }
        }

        function printResults() {
            window.print();
        }

        function takeScreenshot() {
            const element = document.getElementById('resultsContainer');
            if (!element) {
                showToast(t('toastNoResult'), true);
                return;
            }

            showToast(t('toastImgGen'));

            // Chart.js ìº”ë²„ìŠ¤ë“¤ì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜
            const canvasElements = element.querySelectorAll('canvas');
            const originalCanvases = [];

            canvasElements.forEach((canvas, index) => {
                try {
                    const dataUrl = canvas.toDataURL('image/png');
                    const img = document.createElement('img');
                    img.src = dataUrl;
                    img.style.width = canvas.offsetWidth + 'px';
                    img.style.height = canvas.offsetHeight + 'px';
                    img.style.maxWidth = '100%';
                    img.className = 'screenshot-canvas-replacement';

                    originalCanvases.push({
                        canvas: canvas,
                        parent: canvas.parentNode,
                        nextSibling: canvas.nextSibling,
                        display: canvas.style.display
                    });

                    canvas.style.display = 'none';
                    canvas.parentNode.insertBefore(img, canvas);
                } catch (e) {
                    console.warn('ìº”ë²„ìŠ¤ ë³€í™˜ ì‹¤íŒ¨:', e);
                }
            });

            setTimeout(() => {
                html2canvas(element, {
                    backgroundColor: '#1a1a2e',
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    logging: false,
                    windowWidth: element.scrollWidth,
                    windowHeight: element.scrollHeight,
                    scrollY: -window.scrollY,
                    scrollX: -window.scrollX,
                    onclone: function(clonedDoc) {
                        // ì„¹ì…˜ ì• ë‹ˆë©”ì´ì…˜ ì œê±° - opacity:0 ì—ì„œ ë©ˆì¶”ëŠ” ë¬¸ì œ í•´ê²°
                        const sections = clonedDoc.querySelectorAll('.section');
                        sections.forEach(s => {
                            s.style.opacity = '1';
                            s.style.transform = 'none';
                            s.style.animation = 'none';
                        });

                        // bg-cardì˜ backdrop-filter ì œê±° ë° ë¶ˆíˆ¬ëª… ë°°ê²½ìœ¼ë¡œ êµì²´
                        const cards = clonedDoc.querySelectorAll('.bg-card');
                        cards.forEach(card => {
                            card.style.backdropFilter = 'none';
                            card.style.webkitBackdropFilter = 'none';
                            card.style.background = 'rgba(22, 33, 62, 1)';
                        });

                        // ë°˜íˆ¬ëª… ë°°ê²½ì„ ë¶ˆíˆ¬ëª…ìœ¼ë¡œ ë³€ê²½
                        const grayBgs = clonedDoc.querySelectorAll('.bg-gray-800');
                        grayBgs.forEach(bg => {
                            bg.style.backgroundColor = 'rgba(31, 41, 55, 1)';
                            bg.style.opacity = '1';
                        });

                        // ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ë³´ì´ë„ë¡ ê°•ì œ ì„¤ì •
                        const allText = clonedDoc.querySelectorAll('.text-cream, .text-gold, .gradient-text, p, span, h1, h2, h3, h4, h5, h6');
                        allText.forEach(el => {
                            el.style.opacity = '1';
                            el.style.visibility = 'visible';
                        });

                        // gradient-textëŠ” html2canvasì—ì„œ ì§€ì› ì•ˆ ë¨ - ì¼ë°˜ ìƒ‰ìƒìœ¼ë¡œ ëŒ€ì²´
                        const gradientTexts = clonedDoc.querySelectorAll('.gradient-text');
                        gradientTexts.forEach(el => {
                            el.style.background = 'none';
                            el.style.webkitBackgroundClip = 'unset';
                            el.style.backgroundClip = 'unset';
                            el.style.webkitTextFillColor = '#d4a574';
                            el.style.color = '#d4a574';
                        });

                        // íˆ´íŒ ìˆ¨ê¸°ê¸°
                        const tooltips = clonedDoc.querySelectorAll('.pillar-tooltip');
                        tooltips.forEach(t => {
                            if (t) t.style.display = 'none';
                        });

                        const hidden = clonedDoc.querySelectorAll('.hidden');
                        hidden.forEach(h => {
                            if (h) h.style.display = 'none';
                        });

                        // ìˆ˜ì • ë²„íŠ¼ ìˆ¨ê¸°ê¸°
                        const editButtons = clonedDoc.querySelectorAll('.edit-button, .pillar-edit-btn');
                        editButtons.forEach(btn => {
                            if (btn) btn.style.display = 'none';
                        });

                        // pillar-box ë°°ê²½ë„ ë¶ˆíˆ¬ëª…í•˜ê²Œ
                        const pillarBoxes = clonedDoc.querySelectorAll('.pillar-box');
                        pillarBoxes.forEach(box => {
                            if (box.classList.contains('wood')) box.style.background = 'linear-gradient(135deg, rgba(76, 175, 80, 0.5), rgba(139, 195, 74, 0.5))';
                            else if (box.classList.contains('fire')) box.style.background = 'linear-gradient(135deg, rgba(244, 67, 54, 0.5), rgba(255, 112, 67, 0.5))';
                            else if (box.classList.contains('earth')) box.style.background = 'linear-gradient(135deg, rgba(255, 193, 7, 0.5), rgba(255, 167, 38, 0.5))';
                            else if (box.classList.contains('metal')) box.style.background = 'linear-gradient(135deg, rgba(189, 189, 189, 0.5), rgba(158, 158, 158, 0.5))';
                            else if (box.classList.contains('water')) box.style.background = 'linear-gradient(135deg, rgba(33, 150, 243, 0.5), rgba(0, 188, 212, 0.5))';
                        });

                        // resultsContainer ìì²´ì— ë°°ê²½ ì§€ì •
                        const container = clonedDoc.getElementById('resultsContainer');
                        if (container) {
                            container.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)';
                            container.style.padding = '20px';
                            container.style.borderRadius = '16px';
                        }
                    }
                }).then(canvas => {
                    originalCanvases.forEach(item => {
                        item.canvas.style.display = item.display || '';
                    });

                    const tempImages = element.querySelectorAll('.screenshot-canvas-replacement');
                    tempImages.forEach(img => img.remove());

                    canvas.toBlob(function(blob) {
                        if (blob) {
                            const url = URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = url;
                            const today = new Date();
                            const dateStr = `${today.getFullYear()}${String(today.getMonth()+1).padStart(2,'0')}${String(today.getDate()).padStart(2,'0')}`;
                            link.download = currentLang === 'ko' ? `í† ì •ë¹„ê²°_ë¶„ì„ê²°ê³¼_${dateStr}.png` : `fortune_analysis_${dateStr}.png`;
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            setTimeout(() => URL.revokeObjectURL(url), 100);
                            showToast(t('toastImgOk'));
                        } else {
                            showToast(t('toastImgFail'), true);
                        }
                    }, 'image/png');
                }).catch(err => {
                    console.error('Screenshot error:', err);

                    originalCanvases.forEach(item => {
                        item.canvas.style.display = item.display || '';
                    });
                    const tempImages = element.querySelectorAll('.screenshot-canvas-replacement');
                    tempImages.forEach(img => img.remove());

                    showToast(t('toastImgFail'), true);
                });
            }, 200);
        }
    </script>
</body>
</html>

